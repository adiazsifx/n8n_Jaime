{"createdAt":"2025-05-15T21:13:22.939Z","updatedAt":"2025-06-27T16:08:24.000Z","id":"SfhJJJaH6ImIHMCv","name":"Wapp_Schedule_Diary","active":false,"isArchived":false,"nodes":[{"parameters":{"operation":"executeQuery","query":"SELECT json_build_object(\n  'data', json_agg(\n    json_build_object(\n      'nombrechat', chat_name,\n      'messages', messages\n    )\n  )\n) AS result\nFROM (\n  SELECT \n    nombrechat AS chat_name,\n    json_agg(\n      json_build_object(\n        'id', id,\n        'dateTime', to_char(\"dateTime\", 'YYYY-MM-DD\"T\"HH24:MI:SS.MS\"Z\"'),\n        'messages', conversation,\n        'pushName', \"pushName\",\n        'participant', participant\n      ) ORDER BY \"dateTime\"\n    ) AS messages\n  FROM messages\n  WHERE \"dateTime\" >= (NOW() - INTERVAL '24 hours')\n  GROUP BY nombrechat\n) subquery;","options":{"connectionTimeout":30,"replaceEmptyStrings":true}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-900,-100],"id":"9353787f-aed9-4cb4-9cc6-9c3e403f9d19","name":"Postgres","credentials":{"postgres":{"id":"i1HXN1QutN6BIHF9","name":"Postgres_whisper"}}},{"parameters":{"promptType":"define","text":"={{ $json['result.data'] }}","options":{"systemMessage":"=ERES UN ANALISTA LINGÜÍSTICO FORENSE ESPECIALIZADO EN DETECCIÓN DE SENTIMIENTOS NEGATIVOS Y SU CAUSALIDAD EN INTERACCIONES DE CLIENTES. YA SE TE HAN PROPORCIONADO TRES VARIABLES CLAVE QUE DEFINEN EL SENTIMIENTO DETECTADO:\n\n- CATEGORÍA DEL SENTIMIENTO: {{ $json.sentimentAnalysis.category }}\n- INTENSIDAD (FUERZA) DEL SENTIMIENTO: {{ $json.sentimentAnalysis.strength }}\n- CONFIANZA DEL ANÁLISIS: {{ $json.sentimentAnalysis.confidence }}\n\n###TU TAREA###\n\nA PARTIR DE ESTA INFORMACIÓN Y EL CONTENIDO COMPLETO DE LOS MENSAJES, DEBES DETECTAR Y EXTRAER LA(S) CAUSA(S) QUE ORIGINARON EL SENTIMIENTO NEGATIVO. ENCONTRARÁS LOS MENSAJES CLAVE, EVALUARÁS EL CONTEXTO Y GENERARÁS UN JSON CON ESTRUCTURA EXACTA PARA GESTIÓN DE CASOS.\n\n###DEVUELVE EXCLUSIVAMENTE ESTE FORMATO JSON###\n\n[\n  {\n    \"nombrechat\": \"<NOMBRE EXACTO DEL CHAT O INTERACCIÓN>\",\n    \"sentimiento_negativo_detectado\": true,\n    \"negativity_score\": {{ $json.sentimentAnalysis.strength }},\n    \"nivel_gravedad\": \"<leve | moderado | grave>\",\n    \"tipo_de_problema\": \"<CLASIFICACIÓN DEL PROBLEMA, EJ: 'impacto crítico en operación', 'mala atención', 'falta de respuesta', etc.>\",\n    \"mensajes_problema\": [\n      {\n        \"id\": \"<ID O IDENTIFICADOR DEL MENSAJE>\",\n        \"fecha\": \"<FECHA EN FORMATO ISO 8601>\",\n        \"texto\": \"<TEXTO ORIGINAL DEL MENSAJE DETONANTE>\",\n        \"autor\": \"<NOMBRE DE QUIEN ESCRIBIÓ EL MENSAJE>\",\n        \"numero\": \"<IDENTIFICADOR DEL REMITENTE>\"\n      }\n    ],\n    \"comentario_interaccion\": \"<ANÁLISIS BREVE PERO CLARO SOBRE POR QUÉ SURGE EL SENTIMIENTO NEGATIVO SEGÚN EL TEXTO, EL TONO Y LA SITUACIÓN REPORTADA>\"\n  }\n]\n\n###CADENA DE PENSAMIENTO PARA GUIAR TU ANÁLISIS###\n\nENTENDER CONTEXTO Y VARIABLES: INTERPRETA {{ $json.sentimentAnalysis.category }} COMO LA CATEGORÍA GLOBAL DEL SENTIMIENTO, USA {{ $json.sentimentAnalysis.strength }} COMO UNA PISTA DE SU GRAVEDAD, Y CONSIDERA {{ $json.sentimentAnalysis.confidence }} PARA RESPALDAR TUS CONCLUSIONES.\n\nEXTRAER: BUSCA EXPRESIONES CLAVE DE QUEJA, URGENCIA, MOLESTIA O DESCONFORMIDAD.\n\nSELECCIONAR: IDENTIFICA EL MENSAJE O GRUPO DE MENSAJES QUE ORIGINARON EL SENTIMIENTO NEGATIVO. DEBEN ESTAR PRESENTES EN mensajes_problema.\n\nANALIZAR: DETERMINA EL TIPO DE PROBLEMA E IMPACTO (LEVE, MODERADO O GRAVE), SEGÚN LENGUAJE Y CONTEXTO.\n\nSINTETIZAR: REDACTA EN comentario_interaccion UNA EXPLICACIÓN DIRECTA DE LO QUE OCURRIÓ Y CÓMO SE RELACIONA CON EL SENTIMIENTO.\n\nVALIDAR: ASEGÚRATE DE QUE TODOS LOS CAMPOS SE LLENEN CORRECTAMENTE, SIN OMITIR INFORMACIÓN RELEVANTE.\n\n###QUÉ NO HACER (NEGATIVE PROMPT)###\n\nNO GENERES TEXTO FUERA DEL JSON\n\nNO CAMBIES EL NOMBRE NI ORDEN DE LOS CAMPOS JSON\n\nNO INCLUYAS EL SENTIMIENTO COMO CATEGORÍA SI YA ESTÁ EN LA VARIABLE\n\nNO IGNORAR LOS MENSAJES DONDE SE DETONA EL SENTIMIENTO\n\nNO DEJES CAMPOS VACÍOS NI AGREGUES DATOS SUPUESTOS O INVENTADOS\n\nNO OMITAS COMENTARIO NI CIERRES LA RESPUESTA SIN JUSTIFICAR EL SENTIMIENTO"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[160,-40],"id":"94a83e36-a879-4501-a5ba-d69108373580","name":"AI Agent"},{"parameters":{"model":{"__rl":true,"value":"llama-3.3-70B-Instruct","mode":"list","cachedResultName":"llama-3.3-70B-Instruct"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[60,140],"id":"b887b076-3904-4b84-be11-cb1d89862f78","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"lu44hoWfCkZALmQk","name":"Api Sentinel"}}},{"parameters":{"jsCode":"const rawData =$json.output ;\n\n// El formato del input parece ser un string JSON con comillas al inicio y final\n// Primero limpiamos posibles comillas extras al inicio y final\nlet cleanData = rawData;\nif (typeof rawData === 'string') {\n  // Eliminar comillas dobles al inicio y final si existen\n  cleanData = rawData.trim();\n  if (cleanData.startsWith('\"') && cleanData.endsWith('\"')) {\n    cleanData = cleanData.substring(1, cleanData.length - 1);\n  }\n  \n  // Reemplazar posibles escapes de comillas dobles\n  cleanData = cleanData.replace(/\\\\\"/g, '\"');\n}\n\n// Intentamos parsear el JSON\nlet parsedData;\ntry {\n  parsedData = JSON.parse(cleanData);\n} catch (error) {\n  console.error('Error al parsear JSON:', error);\n  // Si falla, devolvemos un array vacío o manejamos el error según necesidad\n  parsedData = [];\n}\n\n// Aseguramos que tenemos un array para mapear\nconst itemsArray = Array.isArray(parsedData) ? parsedData : [parsedData];\n\nreturn itemsArray.map(item => {\n  // Objeto de resultado con las propiedades requeridas\n  const result = {\n    json: {\n      nombreChat: item.nombrechat || '',\n      sentimientoNegativo: item.sentimiento_negativo_detectado || false,\n      puntuacionNegatividad: item.negativity_score || 0,\n      nivelGravedad: item.nivel_gravedad || '',\n      tipoProblema: item.tipo_de_problema || '',\n      mensajesProblema: item.mensajes_problema || [],\n      comentarioInteraccion: item.comentario_interaccion || '',\n      executionid:$execution.id,\n      \n      // Extraemos los detalles de todos los mensajes\n      mensajesDetalle: (item.mensajes_problema || []).map(mensaje => ({\n        id: mensaje.id || '',\n        fecha: mensaje.dateTime || '', // Notamos que ahora usa 'dateTime' en lugar de 'fecha'\n        texto: mensaje.texto || '',\n        autor: mensaje.autor || '',\n        numero: mensaje.numero || ''\n      }))\n    }\n  };\n  \n  return result;\n});"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[520,-40],"id":"b0242d5c-d51f-4630-8f7b-9b7aa30a7699","name":"Code","alwaysOutputData":true},{"parameters":{"inputText":"={{ $json['result.data'].messages[0].messages }}","options":{"categories":"Positive, Neutral, Negative","systemPromptTemplate":"You are highly intelligent and accurate sentiment analyzer. Analyze the sentiment of the provided text. Categorize it into one of the following: {categories}. Use the provided formatting instructions. Only output the JSON.","includeDetailedResults":true,"enableAutoFixing":true}},"type":"@n8n/n8n-nodes-langchain.sentimentAnalysis","typeVersion":1,"position":[-240,-140],"id":"4616587f-1b3f-4c09-9a78-a3a42ca3efec","name":"Sentiment Analysis"},{"parameters":{"options":{"reset":false}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[-500,-180],"id":"f4d0d486-69e6-41d7-a12c-50d3b882f26e","name":"Loop Over Items"},{"parameters":{"model":{"__rl":true,"value":"llama-3.3-70B-Instruct","mode":"list","cachedResultName":"llama-3.3-70B-Instruct"},"options":{"temperature":0.3}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-360,140],"id":"a45f0dba-5f7f-463c-bbe9-a4f17b4d1253","name":"OpenAI Chat Model1","credentials":{"openAiApi":{"id":"lu44hoWfCkZALmQk","name":"Api Sentinel"}}},{"parameters":{"fieldToSplitOut":"result.data","include":"allOtherFields","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[-700,-100],"id":"993f5888-6f79-4e94-b273-c7d1adb0cc50","name":"Split Out"},{"parameters":{"keep":"lastItems"},"type":"n8n-nodes-base.limit","typeVersion":1,"position":[-180,-400],"id":"728f20d9-2816-4cee-9176-89edc0bdab67","name":"Limit"},{"parameters":{"jsCode":"const datos = items.map(item => item.json);\n\nfunction generarFilas(datos) {\n  return datos.map(item => `\n    <tr style=\"background:#fff; color:#2d3a4a; border-bottom:1px solid #e3e7ee;\">\n      <td style=\"padding:14px 8px; font-weight:500;\">\n        <span style=\"display:flex; align-items:center; gap:8px;\">\n          <svg width=\"18\" height=\"18\" fill=\"#0033cc\" viewBox=\"0 0 24 24\"><path d=\"M12 12c2.7 0 8 1.34 8 4v2H4v-2c0-2.66 5.3-4 8-4zm0-2a4 4 0 1 1 0-8 4 4 0 0 1 0 8z\"/></svg>\n          ${item.nombrechat}\n        </span>\n      </td>\n      <td style=\"padding:14px 8px; text-align:center;\">\n        <span style=\"display:inline-flex; align-items:center; gap:4px;\">\n          <svg width=\"16\" height=\"16\" fill=\"#e53935\" viewBox=\"0 0 24 24\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z\"/></svg>\n          ${item.sentimientonegativo ? 'Sí' : 'No'}\n        </span>\n      </td>\n      <td style=\"padding:14px 8px; text-align:center; color:#0033cc; font-weight:600; width:90px;\">${Math.round(item.puntuacionnegatividad * 100)}%</td>\n      <td style=\"padding:14px 8px; text-align:center; text-transform:capitalize; width:110px;\">\n        <span style=\"display:inline-flex; align-items:center; gap:4px;\">\n          <svg width=\"16\" height=\"16\" fill=\"#ffa726\" viewBox=\"0 0 24 24\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z\"/></svg>\n          ${item.nivelgravedad}\n        </span>\n      </td>\n      <td style=\"padding:14px 8px; color:#607d8b;\">${item.tipoproblema}</td>\n      <td style=\"padding:14px 8px; color:#607d8b; word-break:break-word; white-space:normal; max-width:320px;\">${item.comentariointeraccion || ''}</td>\n    </tr>\n  `).join('');\n}\n\nconst tablaFilas = generarFilas(datos);\nconst cantidadAlertas = datos.length;\n\nconst plantillaAlerta = `\n<!DOCTYPE html>\n<html lang=\"es\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Alerta de Sentimientos Negativos</title>\n  <style>\n    body {\n      font-family: 'Segoe UI', Arial, sans-serif;\n      color: #2d3a4a;\n      margin: 0;\n      padding: 0;\n      background-color: #f5f7fa;\n    }\n    .container {\n      width: 85vw;\n      max-width: 1200px;\n      min-width: 320px;\n      margin: 0 auto;\n      background: #fff;\n      border-radius: 14px;\n      box-shadow: 0 2px 8px #e3e7ee;\n      border: 1px solid #e3e7ee;\n      padding-bottom: 32px;\n    }\n    .header {\n      background: #fff;\n      border-radius: 14px 14px 0 0;\n      padding: 32px 32px 16px 32px;\n      display: flex;\n      align-items: center;\n      gap: 16px;\n      border-bottom: 1px solid #e3e7ee;\n    }\n    .logo-placeholder {\n      width: 48px;\n      height: 54px;\n      border-radius: 8px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      font-size: 28px;\n      color: #0033cc;\n      font-weight: bold;\n    }\n    .header-title {\n      font-size: 22px;\n      color: #f39c12;\n      font-weight: bold;\n      margin: 0;\n    }\n    .subtitle {\n      font-size: 15px;\n      color: #607d8b;\n      margin: 0 0 8px 0;\n    }\n    .alerts-header {\n      background: #ed1e79;\n      color: #fff;\n      padding: 28px 40px 28px 40px;\n      font-size: 22px;\n      font-weight: bold;\n      border-radius: 16px;\n      margin: 36px 36px 36px 36px;\n      text-align: left;\n      box-shadow: 0 4px 16px #ed1e7933;\n      display: flex;\n      align-items: center;\n      gap: 22px;\n      letter-spacing: 1px;\n      border: 2px solid #fff;\n    }\n    .tabla-alertas {\n      width: 88%;\n      margin: 0 auto 24px auto;\n      background: #fff;\n      border-radius: 8px;\n      box-shadow: 0 1px 4px #e3e7ee;\n      border: 1px solid #e3e7ee;\n      font-size: 15px;\n    }\n    .tabla-alertas th {\n      background: #f5f7fa;\n      color: #0033cc;\n      font-weight: bold;\n      padding: 14px 8px;\n      border-bottom: 1px solid #e3e7ee;\n    }\n    .tabla-alertas td {\n      border-bottom: 1px solid #e3e7ee;\n    }\n    .footer {\n      text-align: center;\n      color: #b3b3b3;\n      font-size: 12px;\n      margin-top: 32px;\n      padding: 16px 0 0 0;\n    }\n    @media (max-width: 650px) {\n      .container { max-width: 98vw; }\n      .tabla-alertas { width: 98%; }\n      .header { flex-direction: column; gap: 8px; padding: 24px 8px 12px 8px; }\n      .alerts-header { margin: 0 8px 18px 8px; }\n    }\n  </style>\n</head>\n<body>\n  <div style=\"\n    width: 85vw;\n    max-width: 1200px;\n    min-width: 320px;\n    margin: 32px auto;\n    border-radius: 18px;\n    background: linear-gradient(90deg, #0033cc 0%, #ed1e79 100%);\n    padding: 1px;\n    box-sizing: border-box;\n  \">\n    <div class=\"container\" style=\"\n      background: #fff;\n      border-radius: 16px;\n      width: 100%;\n      box-sizing: border-box;\n      padding-bottom: 32px;\n    \">\n      <div class=\"header\">\n        <div class=\"logo-placeholder\">\n          <img src=\"https://raw.githubusercontent.com/aifx-dev/repo-images/main/Logo_aifx_Azul_fit.png\" alt=\"Logo IFX\" width=\"60\" height=\"40\" style=\"vertical-align:middle; border-radius:8px; background:#fff;\">\n        </div>\n        <div style=\"margin-left: 15px;\">\n          <div class=\"header-title\">Alerta de Sentimientos Negativos</div>\n          <div class=\"subtitle\">Detección automática de interacciones negativas en chats de soporte</div>\n        </div>\n      </div>\n      <div class=\"alerts-header\" style=\"padding:18px 24px 18px 24px; font-size:18px; border-radius:12px; gap:14px; display:flex; align-items:center;\">\n        <img src=\"https://raw.githubusercontent.com/adiazsifx/img_emails/main/icons8-alerta-48.png\" alt=\"error--v1\" width=\"28\" height=\"28\" style=\"vertical-align:middle; margin-right:12px;\">\n        <span style=\"font-size:19px; font-weight:800; letter-spacing:0.5px; color:#fff; margin-right:14px; text-shadow:0 2px 8px #ed1e7999;\">Alertas destacadas</span>\n        <span style=\"font-size:1.7rem; font-weight:900; color:#fff; line-height:1; text-shadow:0 2px 8px #ed1e7999;\">${cantidadAlertas}</span>\n      </div>\n      <table class=\"tabla-alertas\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n        <thead>\n          <tr>\n            <th>Nombre del Chat</th>\n            <th style=\"width:90px;\">Sentimiento Negativo</th>\n            <th style=\"width:90px;\">Puntuación Negatividad</th>\n            <th style=\"width:110px;\">Nivel de Gravedad</th>\n            <th>Tipo de Problema</th>\n            <th>Comentario</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${tablaFilas}\n        </tbody>\n      </table>\n      <div class=\"footer\">\n        Sistema de Análisis de Sentimientos | © 2025 IFX<br>\n        Esta alerta ha sido generada automáticamente.\n      </div>\n    </div>\n  </div>\n</body>\n</html>\n`;\n\nreturn [\n  {\n    json: {\n      html: plantillaAlerta\n    }\n  }\n];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[420,-400],"id":"84f021df-3953-497c-9e18-648f04ecbaee","name":"BuildHtml_to_Email"},{"parameters":{"rule":{"interval":[{"field":"cronExpression","expression":"0 8,18 * * *"}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-1180,-100],"id":"5430c9ce-f5a5-4418-86fc-f50f5f221fad","name":"Schedule Trigger"},{"parameters":{"method":"POST","url":"http://192.168.2.12:5678/webhook/send-mail-aifx","sendBody":true,"bodyParameters":{"parameters":[{"name":"to","value":"ai@ifxcorp.com"},{"name":"bcc","value":" jaimep@ifxcorp.com, eronchaquira@ifxcorp.com, lgarzon@ifxcorp.com, spduque@ifxcorp.com, adiazs@ifxcorp.com,cnospina@ifxcorp.com, badevia@ifxcorp.com, wrivera@ifxcorp.com, aperez@ifxcorp.com, aguevara@ifxcorp.com, atellez@ifxcorp.com"},{"name":"subject","value":"Alerta de Sentimientos Negativos Ultimas 24hrs"},{"name":"message_html","value":"={{ $json.html }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[700,-400],"id":"31df9724-9cee-45fa-adcf-800eac418fe3","name":"HTTP Request"},{"parameters":{"operation":"select","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"sentiment_results_whatsup","mode":"list","cachedResultName":"sentiment_results_whatsup"},"limit":100,"where":{"values":[{"column":"executionid","value":"={{ $execution.id }}"}]},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[120,-400],"id":"bc888f7b-1fb1-4a01-9d42-c2590d6af96a","name":"BuscarAnalisis","credentials":{"postgres":{"id":"PrpJ8WzpiFemwSbR","name":"AnalisisSentimiento"}}},{"parameters":{"schema":{"__rl":true,"value":"public","mode":"list","cachedResultName":"public"},"table":{"__rl":true,"value":"sentiment_results_whatsup","mode":"list","cachedResultName":"sentiment_results_whatsup"},"columns":{"mappingMode":"defineBelow","value":{"sentimientonegativo":true,"puntuacionnegatividad":"={{ $json.puntuacionNegatividad }}","nombrechat":"={{ $json.nombreChat }}","nivelgravedad":"={{ $json.nivelGravedad }}","tipoproblema":"={{ $json.tipoProblema }}","comentariointeraccion":"={{ $json.comentarioInteraccion }}","executionid":"={{ $json.executionid }}"},"matchingColumns":["id"],"schema":[{"id":"id","displayName":"id","required":false,"defaultMatch":true,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"nombrechat","displayName":"nombrechat","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"sentimientonegativo","displayName":"sentimientonegativo","required":false,"defaultMatch":false,"display":true,"type":"boolean","canBeUsedToMatch":true},{"id":"puntuacionnegatividad","displayName":"puntuacionnegatividad","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true},{"id":"nivelgravedad","displayName":"nivelgravedad","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"tipoproblema","displayName":"tipoproblema","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"comentariointeraccion","displayName":"comentariointeraccion","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"executionid","displayName":"executionid","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"json_data","displayName":"json_data","required":false,"defaultMatch":false,"display":true,"type":"object","canBeUsedToMatch":true,"removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1060,-40],"id":"b0d0c163-45fb-458a-80eb-a5dfbe62da1c","name":"Save DB","credentials":{"postgres":{"id":"PrpJ8WzpiFemwSbR","name":"AnalisisSentimiento"}}}],"connections":{"Postgres":{"main":[[{"node":"Split Out","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"AI Agent":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Save DB","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Limit","type":"main","index":0}],[{"node":"Sentiment Analysis","type":"main","index":0}]]},"OpenAI Chat Model1":{"ai_languageModel":[[{"node":"Sentiment Analysis","type":"ai_languageModel","index":0}]]},"Split Out":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Sentiment Analysis":{"main":[[{"node":"Loop Over Items","type":"main","index":0}],[{"node":"Loop Over Items","type":"main","index":0}],[{"node":"AI Agent","type":"main","index":0}]]},"Limit":{"main":[[{"node":"BuscarAnalisis","type":"main","index":0}]]},"BuildHtml_to_Email":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Postgres","type":"main","index":0}]]},"HTTP Request":{"main":[[]]},"BuscarAnalisis":{"main":[[{"node":"BuildHtml_to_Email","type":"main","index":0}]]},"Save DB":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","timezone":"America/Bogota","callerPolicy":"workflowsFromSameOwner","errorWorkflow":"Txht1wrdLAI370JY","timeSavedPerExecution":60},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"33d3f747-1ab1-4795-9ad1-df86af7c7f1e","triggerCount":1,"tags":[]}