{"createdAt":"2025-04-15T20:50:21.160Z","updatedAt":"2025-05-20T19:03:14.000Z","id":"6OPoBMQaHUd7Qhlm","name":"Analisis de Sentimineto Tickets","active":true,"nodes":[{"parameters":{"httpMethod":"POST","path":"analytics_sent","authentication":"basicAuth","responseMode":"lastNode","options":{"allowedOrigins":"*","rawBody":"={{ true }}","responseContentType":"application/json"}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-340,-40],"id":"5ac3fa16-8d14-47da-a49c-0ff6929fec08","name":"Webhook","webhookId":"b9086e5a-7118-4682-9d60-8a116a55592b","credentials":{"httpBasicAuth":{"id":"Z2VsuZBhF7EOZxLU","name":"Unnamed credential"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"const data = $json; // El JSON validado y completo\n\nconst info = data.info || {};\nconst cierre = data.cierre || {};\nconst messages = data.messages || [];\n\n// Crear encabezado del ticket\nlet markdown = `# Ticket: ${info.casenumber || 'N/A'}\\n\\n`;\nmarkdown += `**Cliente:** ${info.customerName || 'N/A'}  \\n`;\nmarkdown += `**ID Cliente:** ${info.customerID || 'N/A'}  \\n`;\nmarkdown += `**Estado:** ${info.status?.value || 'N/A'}  \\n`;\nmarkdown += `**Prioridad:** ${info.customerType || 'N/A'}  \\n\\n`;\n\n// Sección de interacciones\nmarkdown += `## Historial de Interacciones\\n\\n`;\n\nif (messages.length > 0) {\n  messages\n    .filter(msg => msg.message && !msg.message.includes('[IMAGE]'))\n    .forEach(msg => {\n      const fecha = msg.date || 'Fecha desconocida';\n      const mensaje = msg.message\n        .replace(/\\n/g, ' ')\n        .replace(/\\s+/g, ' ')\n        .trim();\n      \n      markdown += `### ${msg.author?.value || 'Anónimo'} - ${fecha}\\n`;\n      markdown += `${mensaje}\\n\\n`;\n    });\n} else {\n  markdown += \"* No hay interacciones registradas\\n\\n\";\n}\n\n// Sección de cierre\nif (cierre && Object.keys(cierre).length > 0) {\n  markdown += `## Detalles de Cierre\\n\\n`;\n  markdown += `**Motivo:** ${cierre.Reason_for_Closing || 'N/A'}  \\n`;\n  markdown += `**Responsable:** ${cierre.Responsable || 'N/A'}  \\n`;\n  markdown += `**Descripción:** ${cierre.Incident_Description || 'N/A'}  \\n\\n`;\n}\n\n// Devolver como objeto que n8n espera\nreturn {\n  json: {\n    markdownContent: markdown,\n    ticketId: info.casenumber,\n    customerId: info.customerID,\n    status: info.status?.value\n  }\n};\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[500,-60],"id":"59da43a7-2d31-407a-a4c0-1eaf5d54ecd9","name":"Code","alwaysOutputData":true},{"parameters":{"inputText":"={{ $('Code').item.json.markdownContent }}","options":{"categories":"Positive, Neutral, Negative","includeDetailedResults":true,"enableAutoFixing":true}},"type":"@n8n/n8n-nodes-langchain.sentimentAnalysis","typeVersion":1,"position":[1140,-160],"id":"de8de0cd-5734-4f47-a025-17123145fe28","name":"Sentiment Analysis"},{"parameters":{"model":{"__rl":true,"value":"llama-3.3-70B-Instruct","mode":"list","cachedResultName":"llama-3.3-70B-Instruct"},"options":{"temperature":0.3}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[1060,120],"id":"4d971b29-cb01-40e6-852d-83551d7b58e4","name":"OpenAI Chat Model","notesInFlow":true,"credentials":{"openAiApi":{"id":"lu44hoWfCkZALmQk","name":"Api Sentinel"}},"notes":"Utilizando Llama70B"},{"parameters":{"promptType":"define","text":"=Crea un analisis del resultado de analisis de sentmiento\ndonde los mensajes son {{ $('Code').item.json.markdownContent }} y el resultado del analisis es:{{ $json.sentimentAnalysis.category }}\n\nEntrega 3 Recomendaciones para mejorar los resultados del sentimiento del cliente.\n\nIntenta explicar porqué el sentimiento del cliente fue: {{ $json.sentimentAnalysis.category }}\n\nUtiliza la informacion para recomendar acciones\n\nTODOS LOS CASOS YA HAN SIDO CERRADOS, LAS RECOMENDACIONES DEBEN SER PARA FUTUROS CASOS CON EL CLIENTE\n\nUtiliza solo la informacion suministrada.\n\nLimita tu respuesta a maximo 200 Palabras\n\nEntrega la respuesta en formato html, se preciso y corto en la respuesta, estructura la respuesta como: \n\nEntrega la seccion de los mensajes que produce el resultado del sentimiento, toma como base {{ $('Code').item.json.markdownContent }}, muestra solo un fragmento\n\n\nID Cliente:{{ $json.body['datos del ticket'].Incidente.Cliente }}\nTicket: {{ $json.ticketId }}\nSentimiento:{{ $json.sentimentAnalysis.category }}\nRecomendaciones:\n\n1.\n2.\n3.\n\n","hasOutputParser":true,"options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[980,360],"id":"c17b485c-c5e6-4bc5-a816-2919441f26be","name":"AI Agent"},{"parameters":{"assignments":{"assignments":[{"id":"1826b932-5d72-414d-a4c5-9bb71e9a1f63","name":"sentimentAnalysis","value":"={{ $json.sentimentAnalysis }}","type":"object"},{"id":"779e9857-33d0-4db9-9377-6a75da6782b0","name":"ticketId","value":"={{ $('Code').item.json.ticketId }}","type":"string"},{"id":"bea65672-506c-4916-a4b4-66895f6a8809","name":"body['datos del ticket'].Incidente.Cliente","value":"={{ $('Webhook').item.json.body['datos del ticket'].Incidente.Cliente }}","type":"string"},{"id":"a777d42b-9fbf-49ee-baac-45ec92e41b6c","name":"customerId","value":"={{ $('Code').item.json.customerId }}","type":"string"},{"id":"0943427e-dd3c-48c6-ba92-ceb2c3ccfc71","name":"body['datos del ticket'].Incidente.TipoCliente","value":"={{ $('Webhook').item.json.body['datos del ticket'].Incidente.TipoCliente }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[740,360],"id":"d9e51775-7ab8-4712-9133-c75bb3ca6063","name":"Formateo de Campos"},{"parameters":{"assignments":{"assignments":[{"id":"cbecb362-93e1-49c4-a6f9-16adf09f127c","name":"ticketId","value":"={{ $('Formateo de Campos1').item.json.ticketId }}","type":"string"},{"id":"74e97578-bf99-4882-b023-922da8d6b4ba","name":"body['datos del ticket'].Incidente.Cliente","value":"={{ $('Formateo de Campos1').item.json.body['datos del ticket'].Incidente.Cliente }}","type":"string"},{"id":"2282db41-c4b3-4873-8886-5776483d0f30","name":"body['datos del ticket'].Incidente.TipoCliente","value":"={{ $('Formateo de Campos1').item.json.body['datos del ticket'].Incidente.TipoCliente }}","type":"string"},{"id":"c4c1f076-0281-4f7c-8c18-d1d001d7ef86","name":"customerId","value":"={{ $('Formateo de Campos1').item.json.customerId }}","type":"string"},{"id":"7137fb7e-e427-4341-8454-234b94024334","name":"sentimentAnalysis.category","value":"={{ $('Formateo de Campos1').item.json.sentimentAnalysis.category }}","type":"string"},{"id":"9197bc61-a6ba-41c5-8b7f-5894dadd3441","name":"output","value":"={{ $json.output }}","type":"string"},{"id":"091a7ead-afc4-4c03-b1fd-eff7adc60770","name":"sentimentAnalysis.strength","value":"={{ $('Sentiment Analysis').item.json.sentimentAnalysis.strength }}","type":"number"},{"id":"13cfb142-fb3e-4c43-a406-ccd12873bd6f","name":"sentimentAnalysis.confidence","value":"={{ $('Sentiment Analysis').item.json.sentimentAnalysis.confidence }}","type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1400,800],"id":"7872348f-6cc3-485b-a3d3-09278ffa7dab","name":"Formato de Salida Endpoint"},{"parameters":{"promptType":"define","text":"=Crea un analisis del resultado de analisis de sentmiento\ndonde los mensajes son {{ $('Code').item.json.markdownContent }} y el resultado del analisis es:{{ $json.sentimentAnalysis.category }}\n\nEntrega 3 Recomendaciones para mejorar los resultados del sentimiento del cliente.\n\nExtrae el fragmento de la informacion compartida que define el sentimiento del analisis\n\nIntenta explicar porqué el sentimiento del cliente fue: {{ $json.sentimentAnalysis.category }}\n\nUtiliza la informacion para recomendar acciones\n\nTODOS LOS CASOS YA HAN SIDO CERRADOS, LAS RECOMENDACIONES DEBEN SER PARA FUTUROS CASOS CON EL CLIENTE\n\nUtiliza solo la informacion suministrada.\n\nEntrega la respuesta en formato html, se preciso y corto en la respuesta, estructura la respuesta como: \n\nEntrega la seccion de los mensajes que produce el resultado del sentimiento, toma como base {{ $('Code').item.json.markdownContent }}, muestra solo un fragmento\n\n\nID Cliente:{{ $json.body['datos del ticket'].Incidente.Cliente }}\nTicket: {{ $json.ticketId }}\nSentimiento:{{ $json.sentimentAnalysis.category }}\nRecomendaciones:\n\n1.\n2.\n3.\n","options":{}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[980,800],"id":"6ea04343-fc33-4e15-ae51-489af4f63afd","name":"AI Agent1"},{"parameters":{"model":{"__rl":true,"value":"llama-3.3-70B-Instruct","mode":"list","cachedResultName":"llama-3.3-70B-Instruct"},"options":{"temperature":0.3}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[920,1000],"id":"8b88ac20-8ec6-498a-a7b7-1cd5ced71831","name":"OpenAI Chat Model2","credentials":{"openAiApi":{"id":"lu44hoWfCkZALmQk","name":"Api Sentinel"}}},{"parameters":{"assignments":{"assignments":[{"id":"1826b932-5d72-414d-a4c5-9bb71e9a1f63","name":"sentimentAnalysis","value":"={{ $json.sentimentAnalysis }}","type":"object"},{"id":"779e9857-33d0-4db9-9377-6a75da6782b0","name":"ticketId","value":"={{ $('Code').item.json.ticketId }}","type":"string"},{"id":"bea65672-506c-4916-a4b4-66895f6a8809","name":"body['datos del ticket'].Incidente.Cliente","value":"={{ $('Webhook').item.json.body['datos del ticket'].Incidente.Cliente }}","type":"string"},{"id":"a777d42b-9fbf-49ee-baac-45ec92e41b6c","name":"customerId","value":"={{ $('Code').item.json.customerId }}","type":"string"},{"id":"0943427e-dd3c-48c6-ba92-ceb2c3ccfc71","name":"body['datos del ticket'].Incidente.TipoCliente","value":"={{ $('Webhook').item.json.body['datos del ticket'].Incidente.TipoCliente }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[760,800],"id":"21cc17d9-ac53-4842-aa0d-1bde066cfaf1","name":"Formateo de Campos1"},{"parameters":{"assignments":{"assignments":[{"id":"cbecb362-93e1-49c4-a6f9-16adf09f127c","name":"ticketId","value":"={{ $('Formateo de Campos').item.json.ticketId }}","type":"string"},{"id":"74e97578-bf99-4882-b023-922da8d6b4ba","name":"body['datos del ticket'].Incidente.Cliente","value":"={{ $('Formateo de Campos').item.json.body['datos del ticket'].Incidente.Cliente }}","type":"string"},{"id":"2282db41-c4b3-4873-8886-5776483d0f30","name":"body['datos del ticket'].Incidente.TipoCliente","value":"={{ $('Formateo de Campos').item.json.body['datos del ticket'].Incidente.TipoCliente }}","type":"string"},{"id":"c4c1f076-0281-4f7c-8c18-d1d001d7ef86","name":"customerId","value":"={{ $('Formateo de Campos').item.json.customerId }}","type":"string"},{"id":"7137fb7e-e427-4341-8454-234b94024334","name":"sentimentAnalysis.category","value":"={{ $('Formateo de Campos').item.json.sentimentAnalysis.category }}","type":"string"},{"id":"9197bc61-a6ba-41c5-8b7f-5894dadd3441","name":"output","value":"={{ $json.output }}","type":"string"},{"id":"d6b6375b-a54b-4b90-9d48-12eaaeec2179","name":"sentimentAnalysis.strength","value":"={{ $('Sentiment Analysis').item.json.sentimentAnalysis.strength }}","type":"number"},{"id":"755c9bd0-09b5-482b-9e3e-c9face2e5d46","name":"sentimentAnalysis.confidence","value":"={{ $('Sentiment Analysis').item.json.sentimentAnalysis.confidence }}","type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1400,360],"id":"49cf1e48-e743-4da5-b0ac-b0f44d46f66c","name":"Formato de Salida Endpoint_2"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.1,"position":[1740,0],"id":"01b55b63-01e7-4690-82aa-3cd463953077","name":"Merge"},{"parameters":{"jsCode":"// Acceder correctamente a los datos en n8n\nconst items = $input.all();\nconst result = [];\n\nfor (let i = 0; i < items.length; i++) {\n  // Crear una copia del objeto json\n  const newJson = {...items[i].json};\n  \n  // Convertir customerId a número\n  newJson.customerId = Number(newJson.customerId);\n  \n  // Crear un nuevo objeto item con el json modificado\n  const newItem = {\n    json: newJson\n  };\n  \n  // Añadir al array de resultados\n  result.push(newItem);\n}\n\nreturn result;"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1900,0],"id":"faad6b84-c839-4bb2-9b58-a6b6abe1aa47","name":"ConverToIntegerCID"},{"parameters":{"operation":"select","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"sentiment_results","mode":"list","cachedResultName":"sentiment_results"},"where":{"values":[{"column":"caseid","value":"={{ $json.ticketId }}"}]},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[760,-260],"id":"ba4991b1-3251-4b5a-8485-6c0e08ed55f0","name":"busca_tt","alwaysOutputData":true,"credentials":{"postgres":{"id":"PrpJ8WzpiFemwSbR","name":"AnalisisSentimiento"}},"disabled":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b62bee51-2b11-49c3-821a-2bcf233837f2","leftValue":"={{ $json.id }}","rightValue":"","operator":{"type":"number","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1160,-500],"id":"280764ed-51bf-41b8-81d2-84e5b5621321","name":"If"},{"parameters":{"assignments":{"assignments":[{"id":"6f66879d-96f1-48eb-9fd9-6156226cc3d8","name":"success","value":true,"type":"boolean"},{"id":"cbecb362-93e1-49c4-a6f9-16adf09f127c","name":"ticketId","value":"={{ $json.caseid }}","type":"string"},{"id":"74e97578-bf99-4882-b023-922da8d6b4ba","name":"cierre","value":"={{ $json.json_data }}","type":"string"},{"id":"c4c1f076-0281-4f7c-8c18-d1d001d7ef86","name":"customerId","value":"={{ $json.cid }}","type":"string"},{"id":"7137fb7e-e427-4341-8454-234b94024334","name":"sentimentAnalysis.category","value":"={{ $json.sentiment }}","type":"string"},{"id":"9197bc61-a6ba-41c5-8b7f-5894dadd3441","name":"output","value":"={{ $json.analisis }}","type":"string"},{"id":"091a7ead-afc4-4c03-b1fd-eff7adc60770","name":"sentimentAnalysis.strength","value":"={{ $json.strength }}","type":"number"},{"id":"13cfb142-fb3e-4c43-a406-ccd12873bd6f","name":"sentimentAnalysis.confidence","value":"={{ $json.confidence }}","type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1680,-520],"id":"9c3b82ed-39be-42ea-9e8a-fd485cb82ef7","name":"Formato de Salida Bd"},{"parameters":{"schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"sentiment_results","mode":"list","cachedResultName":"sentiment_results"},"columns":{"mappingMode":"defineBelow","value":{"strength":"={{ $json.sentimentAnalysis.strength }}","confidence":"={{ $json.sentimentAnalysis.confidence }}","caseid":"={{ $json.ticketId }}","customer":"={{ $json.body['datos del ticket'].Incidente.Cliente }}","cid":"={{ $json.customerId }}","sentiment":"={{ $json.sentimentAnalysis.category }}","analisis":"={{ $json.output }}","json_data":"={{ $('If1').item.json.data[\"datos del ticket\"].cierre }}"},"matchingColumns":["id"],"schema":[{"id":"id","displayName":"id","required":false,"defaultMatch":true,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"created_at","displayName":"created_at","required":false,"defaultMatch":false,"display":true,"type":"dateTime","canBeUsedToMatch":true,"removed":true},{"id":"cid","displayName":"cid","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true},{"id":"customer","displayName":"customer","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"caseid","displayName":"caseid","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"sentiment","displayName":"sentiment","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"strength","displayName":"strength","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true},{"id":"confidence","displayName":"confidence","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true},{"id":"json_data","displayName":"json_data","required":false,"defaultMatch":false,"display":true,"type":"object","canBeUsedToMatch":true},{"id":"analisis","displayName":"analisis","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[2060,0],"id":"52cef3e0-250e-4589-af8a-a4146270b59d","name":"Postgres","credentials":{"postgres":{"id":"i1HXN1QutN6BIHF9","name":"Postgres_whisper"}},"disabled":true},{"parameters":{"jsCode":"const input = $input.first().json.body;\n\n// Validar existencia general\nif (!input.info || !input.messages || !input.cierre) {\n  throw new Error('Faltan secciones del JSON: se esperaba \"info\", \"messages\" y \"cierre\" en el mismo objeto.');\n}\n\n// Función utilitaria para validar campos\nfunction validateField(obj, key, type = 'string', required = true) {\n  if (!obj.hasOwnProperty(key)) {\n    if (required) throw new Error(`Falta la clave: ${key}`);\n    return;\n  }\n  if (type === 'object') {\n    if (typeof obj[key] !== 'object' || obj[key] === null || Array.isArray(obj[key])) {\n      throw new Error(`La clave \"${key}\" debe ser un objeto`);\n    }\n  } else if (type === 'array') {\n    if (!Array.isArray(obj[key])) {\n      throw new Error(`La clave \"${key}\" debe ser un array`);\n    }\n  } else {\n    if (typeof obj[key] !== type) {\n      throw new Error(`La clave \"${key}\" debe ser de tipo ${type}`);\n    }\n  }\n}\n\n// Validar \"info\"\nconst info = input.info;\n\n['id', 'title', 'casenumber', 'customerID', 'customerName', 'customerType', 'startdate', 'enddate', 'phonealt']\n  .forEach(key => validateField(info, key));\n\n['assigned', 'type', 'type_event', 'creator', 'category', 'services', 'status']\n  .forEach(key => {\n    validateField(info, key, 'object');\n    validateField(info[key], 'id');\n    validateField(info[key], 'value');\n  });\n\n// Validar \"messages\"\nvalidateField(input, 'messages', 'array');\ninput.messages.forEach((msg, i) => {\n  try {\n    validateField(msg, 'id');\n    validateField(msg, 'author', 'object');\n    validateField(msg.author, 'id');\n    validateField(msg.author, 'value');\n    validateField(msg, 'authoremail');\n    validateField(msg, 'date');\n    validateField(msg, 'datesecs', 'number');\n    validateField(msg, 'message');\n    // \"attachment\" es opcional\n  } catch (e) {\n    throw new Error(`Error en messages[${i}]: ${e.message}`);\n  }\n});\n\n// Validar \"cierre\"\nconst cierre = input.cierre;\n\n[\n  'CaseId', 'Company', 'Imputabilidad', 'Responsable',\n  'Unavailable_Minutes', 'unavailable_to_report_minutes',\n  'Type_of_Unavailable', 'date_upgrade_services_affecte',\n  'General_description_cause', 'Servicio', 'Area',\n  'person_confirms_closure', 'overview_fall', 'Reason_for_Closing',\n  'SubReason_for_Closing', 'Equipment', 'Node', 'Displacement',\n  'Reason_Displacement', 'Include_Report', 'Cause_Internal_Error',\n  'email_confirm_close', 'Development_Process_Realized',\n  'Incident_Description', 'Action_Plan'\n].forEach(key => validateField(cierre, key, 'string', false));\n\n// ✅ Si todo es válido, retornar el JSON original\nreturn [{ \n    json: input \n  }];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-100,-40],"id":"f1c8d964-cc15-4db2-9058-c00d72cc8eab","name":"ValidoJson"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8cb42c2f-9353-4efe-86a6-4cbd44dd8af5","leftValue":"={{ $json.info }}","rightValue":"","operator":{"type":"object","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[180,-40],"id":"0505b532-7798-4552-bf49-4e2bcfb8b0cf","name":"If1"},{"parameters":{"assignments":{"assignments":[{"id":"f331282d-3e11-4107-8018-c668b98d0317","name":"success","value":false,"type":"boolean"},{"id":"cbecb362-93e1-49c4-a6f9-16adf09f127c","name":"ticketId","value":"=","type":"string"},{"id":"74e97578-bf99-4882-b023-922da8d6b4ba","name":"body['datos del ticket'].Incidente.Cliente","value":"=","type":"string"},{"id":"c4c1f076-0281-4f7c-8c18-d1d001d7ef86","name":"customerId","value":"=","type":"string"},{"id":"7137fb7e-e427-4341-8454-234b94024334","name":"sentimentAnalysis.category","value":"=","type":"string"},{"id":"9197bc61-a6ba-41c5-8b7f-5894dadd3441","name":"output","value":"=** ERROR ** Json no valido !  {{ $json.message }}","type":"string"},{"id":"091a7ead-afc4-4c03-b1fd-eff7adc60770","name":"sentimentAnalysis.strength","value":"=","type":"number"},{"id":"13cfb142-fb3e-4c43-a406-ccd12873bd6f","name":"sentimentAnalysis.confidence","value":"=","type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[420,-300],"id":"cd6ba465-a9b2-4069-aa27-eba497f2b4c9","name":"ErrorJsonOutput"},{"parameters":{"model":{"__rl":true,"value":"llama-4-Scout","mode":"list","cachedResultName":"llama-4-Scout"},"options":{"temperature":0.3}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[920,560],"id":"80d65ad8-b4e4-45f2-bfc1-fa2cef844969","name":"OpenAI Chat Model3","notesInFlow":true,"credentials":{"openAiApi":{"id":"lu44hoWfCkZALmQk","name":"Api Sentinel"}},"notes":"Utiliza llama 8B"},{"parameters":{"fromEmail":"aifx@ifxcorp.com","toEmail":"sadian88@gmail.com; jaimep@ifxcorp.com;adiazs@ifxcorp.com;jfernandez@ifxcorp.com;begonzalez@ifxcorp.com","subject":"=Analisisde sentimiento:  {{ $json.ticketId }}  -  {{ $json.sentimentAnalysis.category }}","html":"=<!DOCTYPE html>\n<html lang=\"es\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>AIFXNetworks - Análisis de Sentimientos</title>\n</head>\n<body style=\"background:#fff; margin:32px; padding:0; font-family: Arial, Verdana, sans-serif;\">\n  <table width=\"80%\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background:#fff; border-radius:10px; box-shadow:0 2px 8px #e3e7ee; border:1px solid #e3e7ee; margin:32px auto;\">\n    <tr>\n      <td style=\"background:#162447; border-radius:10px 10px 0 0; padding:18px 24px; color:#fff; font-size:20px; font-weight:bold; font-family: Arial, Verdana, sans-serif;\">\n        <img src=\"https://img.icons8.com/color/48/000000/artificial-intelligence.png\" alt=\"Logo\" width=\"28\" height=\"28\" style=\"vertical-align:middle; background:#fff; border-radius:6px; padding:2px; margin-right:10px;\">AIFXNetworks - Análisis de Sentimientos\n      </td>\n    </tr>\n    <tr>\n      <td style=\"padding:48px 64px 32px 64px;\">\n        <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background:#f0f3f8; border-radius:6px; font-size:14px; margin-bottom:18px;\">\n          <tr>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold; width:140px;\">\n              <img src=\"https://img.icons8.com/color/48/000000/user.png\" width=\"20\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Nombre del Cliente:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\">{{ $('Merge_salida').item.json.customerId }}</td>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold; width:120px;\">\n              <img src=\"https://img.icons8.com/color/48/000000/barcode.png\" width=\"20\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Número de Caso:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\">{{ $('Merge_salida').item.json.ticketId }}</td>\n          </tr>\n          <tr>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold;\">\n              <img src=\"https://img.icons8.com/color/48/000000/planner.png\" width=\"16\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Fecha:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\">{{ $('Webhook').item.json.body.info.startdate }}</td>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold;\">\n              <img src=\"https://img.icons8.com/color/48/000000/topic.png\" width=\"20\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Asunto del Caso:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\"> {{ $('Webhook').item.json.body.info.category.value }} </td>\n          </tr>\n        </table>\n        <div style=\"font-size:18px; color:#1a237e; font-weight:bold; margin-bottom:16px;\">Resultado del Análisis de Sentimientos</div>\n\n        <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background:#f5f7fa; border-left:5px solid #90a4ae; border-radius:6px; margin-bottom:18px;\">\n          <tr>\n            <td style=\"padding:14px 12px;\">\n              <img src=\"https://img.icons8.com/ios-filled/50/90a4ae/neutral-emoticon.png\" width=\"22\" height=\"22\" style=\"vertical-align:middle; margin-right:8px;\">\n              <span style=\"font-size:15px; color:#1a237e; font-weight:bold; vertical-align:middle;\">Sentimiento Neutral</span>\n              <div style=\"font-size:13px; color:#2d3a4a; margin-top:6px; margin-left:30px;\">{{ $('Merge_salida').item.json.output }}</div>\n            </td>\n          </tr>\n        </table>\n\n        <hr style=\"border:none; border-top:1px solid #e3e7ee; margin:18px 0 10px 0;\">\n        <div style=\"font-size:13px; color:#1a237e; font-weight:bold; display:inline;\"></div>\n        <span style=\"font-size:13px; color:#222;\"> </span>\n      </td>\n    </tr>\n  </table>\n</body>\n</html> ","options":{"appendAttribution":false}},"type":"n8n-nodes-base.emailSend","typeVersion":2.1,"position":[2680,-460],"id":"35ea26a0-2053-4c77-ab7d-1fafa6ba942c","name":"Send Email","webhookId":"8049283c-6b76-493e-ba58-3aec2fe235eb","credentials":{"smtp":{"id":"K7Y8XXXqNwyqSCdz","name":"SMTP account 2"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8261ecd4-5d63-40d3-a197-84ec088319e4","leftValue":"={{ $json.sentimentAnalysis.category }}","rightValue":"Positive","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Positive"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.sentimentAnalysis.category }}","rightValue":"Neutral","operator":{"type":"string","operation":"equals"},"id":"9711ac4e-3710-4f8f-8ff5-c55e9e8aa705"}],"combinator":"and"},"renameOutput":true,"outputKey":"Neutral"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"f8ac4b5e-0426-4b4b-a19c-1d75ce44e5e9","leftValue":"={{ $json.sentimentAnalysis.category }}","rightValue":"Negative","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"Negative"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[2340,-460],"id":"5545d67a-f780-4f23-b628-d345318ff242","name":"Switch"},{"parameters":{"fromEmail":"aifx@ifxcorp.com","toEmail":"sadian88@gmail.com; jaimep@ifxcorp.com;adiazs@ifxcorp.com;jfernandez@ifxcorp.com;begonzalez@ifxcorp.com","subject":"=Analisisde sentimiento:  {{ $json.ticketId }}  -  {{ $json.sentimentAnalysis.category }}","html":"=<!DOCTYPE html>\n<html lang=\"es\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>AIFXNetworks - Análisis de Sentimientos</title>\n</head>\n<body style=\"background:#fff; margin:32px; padding:0; font-family: Arial, Verdana, sans-serif;\">\n  <table width=\"80%\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background:#fff; border-radius:10px; box-shadow:0 2px 8px #e3e7ee; border:1px solid #e3e7ee; margin:32px auto;\">\n    <tr>\n      <td style=\"background:#162447; border-radius:10px 10px 0 0; padding:18px 24px; color:#fff; font-size:20px; font-weight:bold; font-family: Arial, Verdana, sans-serif;\">\n        <img src=\"https://img.icons8.com/color/48/000000/artificial-intelligence.png\" alt=\"Logo\" width=\"28\" height=\"28\" style=\"vertical-align:middle; background:#fff; border-radius:6px; padding:2px; margin-right:10px;\">AIFXNetworks - Análisis de Sentimientos\n      </td>\n    </tr>\n    <tr>\n      <td style=\"padding:48px 64px 32px 64px;\">\n        <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background:#f0f3f8; border-radius:6px; font-size:14px; margin-bottom:18px;\">\n          <tr>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold; width:140px;\">\n              <img src=\"https://img.icons8.com/color/48/000000/user.png\" width=\"16\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Nombre del Cliente:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\">{{ $json.customerId }}</td>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold; width:120px;\">\n              <img src=\"https://img.icons8.com/color/48/000000/barcode.png\" width=\"16\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Número de Caso:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\">  {{ $json.ticketId }} </td>\n          </tr>\n          <tr>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold;\">\n              <img src=\"https://img.icons8.com/color/48/000000/planner.png\" width=\"16\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Fecha:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\">{{ $('Webhook').item.json.body.info.startdate }} </td>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold;\">\n              <img src=\"https://img.icons8.com/color/48/000000/topic.png\" width=\"16\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Asunto del Caso:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\">{{ $('Webhook').item.json.body.info.category.value }} </td>\n          </tr>\n        </table>\n        <div style=\"font-size:18px; color:#1a237e; font-weight:bold; margin-bottom:16px;\">Resultado del Análisis de Sentimientos</div>\n        <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background:#eaf6f0; border-left:5px solid #2196f3; border-radius:6px; margin-bottom:18px;\">\n          <tr>\n            <td style=\"padding:14px 12px;\">\n              <img src=\"https://img.icons8.com/ios-filled/50/2196f3/happy.png\" width=\"22\" height=\"22\" style=\"vertical-align:middle; margin-right:8px;\">\n              <span style=\"font-size:15px; color:#1a237e; font-weight:bold; vertical-align:middle;\">Sentimiento Positivo</span>\n              <div style=\"font-size:13px; color:#2d3a4a; margin-top:6px; margin-left:30px;\"> {{ $json.output }}</div>\n            </td>\n          </tr>\n        </table>\n        <hr style=\"border:none; border-top:1px solid #e3e7ee; margin:18px 0 10px 0;\">\n        <div style=\"font-size:13px; color:#1a237e; font-weight:bold; display:inline;\"></div>\n        <span style=\"font-size:13px; color:#222;\"> </span>\n      </td>\n    </tr>\n  </table>\n</body>\n</html> ","options":{"appendAttribution":false}},"type":"n8n-nodes-base.emailSend","typeVersion":2.1,"position":[2680,-640],"id":"be3ff8dc-05db-4a2c-8302-ec3387f9e47e","name":"Send Email Positive","webhookId":"8049283c-6b76-493e-ba58-3aec2fe235eb","credentials":{"smtp":{"id":"K7Y8XXXqNwyqSCdz","name":"SMTP account 2"}}},{"parameters":{"fromEmail":"aifx@ifxcorp.com","toEmail":"sadian88@gmail.com; jaimep@ifxcorp.com;adiazs@ifxcorp.com;jfernandez@ifxcorp.com;begonzalez@ifxcorp.com","subject":"=Analisisde sentimiento:  {{ $json.ticketId }}  -  {{ $json.sentimentAnalysis.category }}","html":"=<!DOCTYPE html>\n<html lang=\"es\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>AIFXNetworks - Análisis de Sentimientos</title>\n</head>\n<body style=\"background:#fff; margin:32px; padding:0; font-family: Arial, Verdana, sans-serif;\">\n  <table width=\"80%\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background:#fff; border-radius:10px; box-shadow:0 2px 8px #e3e7ee; border:1px solid #e3e7ee; margin:32px auto;\">\n    <tr>\n      <td style=\"background:#162447; border-radius:10px 10px 0 0; padding:18px 24px; color:#fff; font-size:20px; font-weight:bold; font-family: Arial, Verdana, sans-serif;\">\n        <img src=\"https://img.icons8.com/color/48/000000/artificial-intelligence.png\" alt=\"Logo\" width=\"28\" height=\"28\" style=\"vertical-align:middle; background:#fff; border-radius:6px; padding:2px; margin-right:10px;\">AIFXNetworks - Análisis de Sentimientos\n      </td>\n    </tr>\n    <tr>\n      <td style=\"padding:48px 64px 32px 64px;\">\n        <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background:#f0f3f8; border-radius:6px; font-size:14px; margin-bottom:18px;\">\n          <tr>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold; width:140px;\">\n              <img src=\"https://img.icons8.com/color/48/000000/user.png\" width=\"16\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Nombre del Cliente:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\">{{ $('Merge_salida').item.json.customerId }}</td>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold; width:120px;\">\n              <img src=\"https://img.icons8.com/color/48/000000/barcode.png\" width=\"16\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Número de Caso:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\"> {{ $('Merge_salida').item.json.ticketId }}</td>\n          </tr>\n          <tr>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold;\">\n              <img src=\"https://img.icons8.com/color/48/000000/planner.png\" width=\"16\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Fecha:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\"> {{ $('Webhook').item.json.body.info.startdate }}</td>\n            <td style=\"padding:8px 10px; color:#1a237e; font-weight:bold;\">\n              <img src=\"https://img.icons8.com/color/48/000000/topic.png\" width=\"16\" height=\"16\" style=\"vertical-align:middle; margin-right:4px;\">Asunto del Caso:\n            </td>\n            <td style=\"padding:8px 10px; color:#222;\">{{ $('Webhook').item.json.body.info.category.value }} </td>\n          </tr>\n        </table>\n        <div style=\"font-size:18px; color:#1a237e; font-weight:bold; margin-bottom:16px;\">Resultado del Análisis de Sentimientos</div>\n\n        <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background:#fbeaea; border-left:5px solid #e53935; border-radius:6px; margin-bottom:18px;\">\n          <tr>\n            <td style=\"padding:14px 12px;\">\n              <img src=\"https://img.icons8.com/ios-filled/50/e53935/sad.png\" width=\"22\" height=\"22\" style=\"vertical-align:middle; margin-right:8px;\">\n              <span style=\"font-size:15px; color:#1a237e; font-weight:bold; vertical-align:middle;\">Sentimiento Negativo</span>\n              <div style=\"font-size:13px; color:#2d3a4a; margin-top:6px; margin-left:30px;\"> {{ $json.output }}</div>\n            </td>\n          </tr>\n        </table>\n\n        <hr style=\"border:none; border-top:1px solid #e3e7ee; margin:18px 0 10px 0;\">\n        <div style=\"font-size:13px; color:#1a237e; font-weight:bold; display:inline;\"></div>\n        <span style=\"font-size:13px; color:#222;\"> </span>\n      </td>\n    </tr>\n  </table>\n</body>\n</html> ","options":{"appendAttribution":false}},"type":"n8n-nodes-base.emailSend","typeVersion":2.1,"position":[2680,-260],"id":"81f4dedc-bcd4-4b95-9b11-580c5826f849","name":"Send Email Negative","webhookId":"8049283c-6b76-493e-ba58-3aec2fe235eb","credentials":{"smtp":{"id":"K7Y8XXXqNwyqSCdz","name":"SMTP account 2"}}},{"parameters":{"assignments":{"assignments":[{"id":"9e53b0cd-faa0-4e0e-84d0-5d4d66e7a731","name":"success","value":"={{ $('Switch').item.json.success }}","type":"boolean"},{"id":"cbecb362-93e1-49c4-a6f9-16adf09f127c","name":"ticketId","value":"={{ $('Switch').item.json.ticketId }}","type":"string"},{"id":"74e97578-bf99-4882-b023-922da8d6b4ba","name":"cierre","value":"={{ $('Switch').item.json.cierre }}","type":"string"},{"id":"c4c1f076-0281-4f7c-8c18-d1d001d7ef86","name":"customerId","value":"={{ $('Switch').item.json.customerId }}","type":"string"},{"id":"7137fb7e-e427-4341-8454-234b94024334","name":"sentimentAnalysis.category","value":"={{ $('Switch').item.json.sentimentAnalysis.category }}","type":"string"},{"id":"091a7ead-afc4-4c03-b1fd-eff7adc60770","name":"sentimentAnalysis.strength","value":"={{ $('Switch').item.json.sentimentAnalysis.strength }}","type":"number"},{"id":"13cfb142-fb3e-4c43-a406-ccd12873bd6f","name":"sentimentAnalysis.confidence","value":"={{ $('Switch').item.json.sentimentAnalysis.confidence }}","type":"number"},{"id":"9197bc61-a6ba-41c5-8b7f-5894dadd3441","name":"output","value":"={{ $('Switch').item.json.output }}","type":"string"},{"id":"5afa953c-e9f8-4349-b557-515b527b84d3","name":"","value":"","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[3040,-460],"id":"53bbf65f-165a-4c20-9661-53beda042a6d","name":"Formato de Salida Bd2"},{"parameters":{"assignments":{"assignments":[{"id":"9e53b0cd-faa0-4e0e-84d0-5d4d66e7a731","name":"success","value":true,"type":"boolean"},{"id":"cbecb362-93e1-49c4-a6f9-16adf09f127c","name":"ticketId","value":"={{ $('ConverToIntegerCID').item.json.ticketId }}","type":"string"},{"id":"74e97578-bf99-4882-b023-922da8d6b4ba","name":"cierre","value":"=","type":"string"},{"id":"c4c1f076-0281-4f7c-8c18-d1d001d7ef86","name":"customerId","value":"={{ $('ConverToIntegerCID').item.json.customerId }}","type":"string"},{"id":"7137fb7e-e427-4341-8454-234b94024334","name":"sentimentAnalysis.category","value":"={{ $('ConverToIntegerCID').item.json.sentimentAnalysis.category }}","type":"string"},{"id":"9197bc61-a6ba-41c5-8b7f-5894dadd3441","name":"output","value":"={{ $('ConverToIntegerCID').item.json.output }}","type":"string"},{"id":"091a7ead-afc4-4c03-b1fd-eff7adc60770","name":"sentimentAnalysis.strength","value":"={{ $('ConverToIntegerCID').item.json.sentimentAnalysis.strength }}","type":"number"},{"id":"13cfb142-fb3e-4c43-a406-ccd12873bd6f","name":"sentimentAnalysis.confidence","value":"={{ $('ConverToIntegerCID').item.json.sentimentAnalysis.confidence }}","type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1680,-360],"id":"9948c035-a343-471d-bdd6-bb34f2bfc706","name":"Formato de Salida Bd1"},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.1,"position":[1980,-460],"id":"fe74077d-fdac-45e0-af76-7a478aee28f9","name":"Merge_salida"}],"connections":{"Webhook":{"main":[[{"node":"ValidoJson","type":"main","index":0}]]},"Code":{"main":[[{"node":"busca_tt","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"Sentiment Analysis","type":"ai_languageModel","index":0}]]},"Sentiment Analysis":{"main":[[{"node":"Formateo de Campos","type":"main","index":0}],[{"node":"Formateo de Campos","type":"main","index":0}],[{"node":"Formateo de Campos1","type":"main","index":0}]]},"AI Agent":{"main":[[{"node":"Formato de Salida Endpoint_2","type":"main","index":0}]]},"Formateo de Campos":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Formato de Salida Endpoint":{"main":[[{"node":"Merge","type":"main","index":1}]]},"OpenAI Chat Model2":{"ai_languageModel":[[{"node":"AI Agent1","type":"ai_languageModel","index":0}]]},"Formateo de Campos1":{"main":[[{"node":"AI Agent1","type":"main","index":0}]]},"AI Agent1":{"main":[[{"node":"Formato de Salida Endpoint","type":"main","index":0}]]},"Formato de Salida Endpoint_2":{"main":[[{"node":"Merge","type":"main","index":0}]]},"Merge":{"main":[[{"node":"ConverToIntegerCID","type":"main","index":0}]]},"ConverToIntegerCID":{"main":[[{"node":"Postgres","type":"main","index":0}]]},"busca_tt":{"main":[[{"node":"If","type":"main","index":0}]]},"If":{"main":[[{"node":"Formato de Salida Bd","type":"main","index":0}],[{"node":"Sentiment Analysis","type":"main","index":0}]]},"Postgres":{"main":[[{"node":"Formato de Salida Bd1","type":"main","index":0}]]},"Formato de Salida Bd":{"main":[[{"node":"Merge_salida","type":"main","index":0}]]},"ValidoJson":{"main":[[{"node":"If1","type":"main","index":0}]]},"If1":{"main":[[{"node":"Code","type":"main","index":0}],[{"node":"ErrorJsonOutput","type":"main","index":0}]]},"OpenAI Chat Model3":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Send Email":{"main":[[{"node":"Formato de Salida Bd2","type":"main","index":0}]]},"Switch":{"main":[[{"node":"Send Email Positive","type":"main","index":0}],[{"node":"Send Email","type":"main","index":0}],[{"node":"Send Email Negative","type":"main","index":0}]]},"Send Email Positive":{"main":[[{"node":"Formato de Salida Bd2","type":"main","index":0}]]},"Send Email Negative":{"main":[[{"node":"Formato de Salida Bd2","type":"main","index":0}]]},"Formato de Salida Bd1":{"main":[[{"node":"Merge_salida","type":"main","index":1}]]},"Merge_salida":{"main":[[{"node":"Switch","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"ac7641d5-5bf3-4810-b171-f317ab012e6e","triggerCount":1,"tags":[]}