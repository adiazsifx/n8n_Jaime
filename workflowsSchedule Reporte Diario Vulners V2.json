{"createdAt":"2025-05-24T21:57:19.749Z","updatedAt":"2025-05-24T23:38:19.000Z","id":"C6afTI5o8i0mmmIL","name":"Schedule Reporte Diario Vulners V2","active":false,"isArchived":false,"nodes":[{"parameters":{"method":"POST","url":"https://vulners.com/api/v3/search/lucene/","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{\n\"query\": \"(Sophos OR HPE OR Veeam OR Fortinet OR Cisco OR Ansible OR Kubernetes OR SolarWinds OR Acronis OR Juniper OR Huawei OR Broadcom OR Chrome OR Edge OR Outlook OR Dell OR IBM OR Hitachi OR Pure OR Mikrotik OR Ubiquiti OR PFSense) order:published\",\n  \"skip\": 0,\n  \"size\": 5,\n  \"fields\": [\"id\", \"published\", \"description\", \"short_description\", \"type\", \"title\", \"cvelist\", \"href\", \"sourceHref\", \"sourceData\", \"cvss\"],\n  \"apiKey\": \"QXJ8W19OX7DSLVL5G5G41DY2E5CSNV6YN1G0DC6ER1CNRKF7PF4E9SPN1WI3UFN1\"\n}\n","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-140,-20],"id":"ab57bf88-175a-4227-8edd-537999eacdd9","name":"HTTP Request"},{"parameters":{"rule":{"interval":[{"triggerAtHour":4,"triggerAtMinute":5}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-340,-20],"id":"6336e21a-6441-46d2-9abe-00888ae2c323","name":"Schedule Trigger"},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-340,-180],"id":"19b7884c-8abe-401f-b16d-b18f4fec9c8d","name":"When clicking ‚ÄòTest workflow‚Äô"},{"parameters":{"toRecipients":"jaimep@ifxcorp.com","subject":"Boletin de Vulnerabilidades - Vulners.com","bodyContent":"={{ $json.htmlEmail }}","additionalFields":{"bodyContentType":"html"}},"type":"n8n-nodes-base.microsoftOutlook","typeVersion":2,"position":[660,580],"id":"6996ae03-858e-4418-ae04-a6d884a0fe0d","name":"Test Mail jaimep@ifxcorp.com","webhookId":"36f4c0d9-f881-42be-8d1b-c84f3ba68e55","credentials":{"microsoftOutlookOAuth2Api":{"id":"xSTIlfhp3ac7TN3h","name":"Mail ai@ifxcorp.com"}}},{"parameters":{"model":{"__rl":true,"value":"llama-4-Scout","mode":"list","cachedResultName":"llama-4-Scout"},"options":{"temperature":0.3}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[20,160],"id":"ebc65cab-562e-4f5e-abe8-20f04164d8b7","name":"Llama 4 Scout","credentials":{"openAiApi":{"id":"3ksygUY2AafRzzfk","name":"Proxy LiteLLM"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.outputParserAutofixing","typeVersion":1,"position":[220,200],"id":"e1d3205c-1f4d-48d9-85ce-de4b49b4c0c1","name":"Auto-fixing Output Parser"},{"parameters":{"jsonSchemaExample":"{\n  \"criticidad\": \"CLASIFICADA\",\n  \"vulnerabilidades_alta\": [\n    {\n      \"fabricante\": \"Microsoft\",\n      \"cve\": \"CVE-2025-47181\",\n      \"fecha_reporte\": \"2025-05-23\",\n      \"producto\": \"Edge\",\n      \"cvss\": 8.8,\n      \"descripcion\": \"Vulnerabilidad de seguimiento de enlaces que podr√≠a permitir a un atacante remoto no autenticado realizar un ataque de scripting entre sitios (XSS).\",\n      \"acciones\": [\n        \"Actualizar Microsoft Edge a la √∫ltima versi√≥n\"\n      ],\n      \"referencias\": [\n        \"GitHub Exploit\"\n      ]\n    }\n  ],\n  \"vulnerabilidades_media\": [\n    {\n      \"fabricante\": \"Cisco\",\n      \"cve\": \"CVE-2025-20246\",\n      \"fecha_reporte\": \"2025-05-23\",\n      \"producto\": \"Webex\",\n      \"cvss\": 6.1,\n      \"descripcion\": \"Vulnerabilidad que podr√≠a permitir a un atacante remoto no autenticado realizar un ataque de scripting entre sitios (XSS).\",\n      \"acciones\": [\n        \"Actualizar Cisco Webex a la √∫ltima versi√≥n\"\n      ],\n      \"referencias\": [\n        \"Red Hat CVE\"\n      ]\n    }\n  ],\n  \"vulnerabilidades_baja\": []\n}\n"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.2,"position":[340,360],"id":"fa42c0df-3641-456c-b31a-64d264ef6cfa","name":"Structured Output Parser"},{"parameters":{"html":"<!DOCTYPE html\n  PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"es\">\n\n<head>\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n  <title>Bolet√≠n de Ciberseguridad</title>\n  <style type=\"text/css\">\n    /* Estilos generales para clientes que los soportan en head */\n    body {\n      margin: 0;\n      padding: 0;\n      background-color: #f4f7f6;\n      font-family: Arial, Helvetica, sans-serif;\n    }\n\n    table {\n      border-collapse: collapse;\n      border-spacing: 0;\n    }\n\n    td {\n      padding: 0;\n      vertical-align: top;\n    }\n\n    a {\n      color: #007bff;\n      text-decoration: none;\n    }\n\n    .container {\n      width: 100%;\n      max-width: 600px;\n      margin: 0 auto;\n      background-color: #ffffff;\n    }\n\n    .header {\n      background-color: #003366;\n      /* Azul oscuro corporativo */\n      color: #ffffff;\n      padding: 20px;\n      text-align: center;\n    }\n\n    .header h1 {\n      margin: 0;\n      font-size: 24px;\n      font-weight: bold;\n    }\n\n    .source-report {\n      padding: 10px 20px;\n      background-color: #e9ecef;\n      font-size: 12px;\n      color: #495057;\n      text-align: right;\n    }\n\n    .summary-section {\n      padding: 20px;\n      background-color: #f8f9fa;\n      border-bottom: 1px solid #dee2e6;\n    }\n\n    .summary-section table {\n      width: 100%;\n    }\n\n    .summary-section td {\n      padding: 5px;\n      font-size: 14px;\n    }\n\n    .summary-label {\n      font-weight: bold;\n      color: #343a40;\n    }\n\n    .summary-count-high {\n      color: #d9534f;\n      font-weight: bold;\n    }\n\n    .summary-count-medium {\n      color: #f0ad4e;\n      font-weight: bold;\n    }\n\n    .summary-count-low {\n      color: #5cb85c;\n      font-weight: bold;\n    }\n\n    .summary-count-total {\n      color: #003366;\n      font-weight: bold;\n    }\n\n    .vuln-section-header {\n      padding: 12px 20px;\n      font-size: 18px;\n      font-weight: bold;\n      color: #ffffff;\n    }\n\n    .criticality-high .vuln-section-header {\n      background-color: #d9534f;\n      /* Rojo */\n    }\n\n    .criticality-medium .vuln-section-header {\n      background-color: #f0ad4e;\n      /* Naranja */\n    }\n\n    .criticality-low .vuln-section-header {\n      background-color: #5cb85c;\n      /* Verde */\n    }\n\n    .vuln-item {\n      padding: 15px 20px;\n      border-bottom: 1px solid #e0e0e0;\n    }\n\n    .vuln-item:last-child {\n      border-bottom: none;\n    }\n\n    .vuln-item table {\n      width: 100%;\n    }\n\n    .vuln-item td {\n      padding: 6px 0;\n      font-size: 14px;\n      line-height: 1.6;\n      color: #333333;\n    }\n\n    .vuln-item .label {\n      font-weight: bold;\n      color: #003366;\n      /* Azul oscuro */\n      width: 150px;\n      /* Ancho fijo para etiquetas */\n    }\n\n    .vuln-item .cvss-score {\n      font-weight: bold;\n      padding: 3px 6px;\n      border-radius: 4px;\n      color: #ffffff;\n      display: inline-block;\n      /* Para que el padding funcione bien */\n    }\n\n    .cvss-high {\n      background-color: #c9302c;\n    }\n\n    /* Rojo oscuro para CVSS alto */\n    .cvss-medium {\n      background-color: #ec971f;\n    }\n\n    /* Naranja oscuro para CVSS medio */\n    .cvss-low {\n      background-color: #4cae4c;\n    }\n\n    /* Verde oscuro para CVSS bajo */\n\n    .recommendations,\n    .references {\n      margin-top: 8px;\n    }\n\n    .recommendations ul,\n    .general-guidelines ul {\n      margin: 5px 0 0 0;\n      padding-left: 20px;\n      /* Sangr√≠a para listas */\n    }\n\n    .recommendations li,\n    .general-guidelines li {\n      margin-bottom: 4px;\n    }\n\n    .general-guidelines-header {\n      padding: 12px 20px;\n      font-size: 18px;\n      font-weight: bold;\n      color: #ffffff;\n      background-color: #005A9C;\n      /* Un azul diferente para distinci√≥n */\n    }\n\n    .general-guidelines {\n      padding: 15px 20px;\n      background-color: #f8f9fa;\n      font-size: 14px;\n      line-height: 1.6;\n      color: #333333;\n    }\n\n    .footer {\n      background-color: #343a40;\n      color: #adb5bd;\n      padding: 15px;\n      text-align: center;\n      font-size: 12px;\n    }\n\n    .footer a {\n      color: #0099cc;\n    }\n\n    /* Estilos espec√≠ficos para Outlook */\n    .ExternalClass {\n      width: 100%;\n    }\n\n    .ExternalClass,\n    .ExternalClass p,\n    .ExternalClass span,\n    .ExternalClass font,\n    .ExternalClass td,\n    .ExternalClass div {\n      line-height: 100%;\n    }\n\n    #outlook a {\n      padding: 0;\n    }\n\n    table {\n      mso-table-lspace: 0pt;\n      mso-table-rspace: 0pt;\n    }\n\n    img {\n      -ms-interpolation-mode: bicubic;\n    }\n  </style>\n</head>\n\n<body style=\"margin: 0; padding: 0; background-color: #f4f7f6; font-family: Arial, Helvetica, sans-serif;\">\n  <table role=\"presentation\" align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"container\"\n    style=\"width: 100%; max-width: 600px; margin: 0 auto; background-color: #ffffff;\">\n    <tr>\n      <td class=\"header\" style=\"background-color: #003366; color: #ffffff; padding: 25px 20px; text-align: center;\">\n        <h1 style=\"margin: 0; font-size: 26px; font-weight: bold; line-height: 1.2;\">Bolet√≠n de Ciberseguridad</h1>\n      </td>\n    </tr>\n    <tr>\n      <td class=\"source-report\"\n        style=\"padding: 10px 20px; background-color: #e9ecef; font-size: 12px; color: #495057; text-align: right;\">\n        FUENTE DEL REPORTE: VULNERS\n      </td>\n    </tr>\n\n    <tr>\n      <td class=\"summary-section-new\"\n        style=\"padding: 20px 20px 25px 20px; background-color: #ffffff; border-bottom: 1px solid #dee2e6;\">\n        <div\n          style=\"font-size: 18px; color: #343a40; font-weight: bold; margin-bottom: 20px; text-align: left; font-family: Arial, Helvetica, sans-serif;\">\n          Resumen del Bolet√≠n:</div>\n        <table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n          <tr>\n            <td align=\"center\"\n              style=\"width: 25%; padding: 0 5px; text-align: center; vertical-align: top; font-family: Arial, Helvetica, sans-serif;\">\n              {{ $('Code').first().json.html_divs.alta }}\n              <div style=\"font-size: 12px; color: #6c757d; line-height: 1.3;\">Vulnerabilidades de Alta Criticidad</div>\n            </td>\n            <td align=\"center\"\n              style=\"width: 25%; padding: 0 5px; text-align: center; vertical-align: top; font-family: Arial, Helvetica, sans-serif;\">\n             {{ $('Code').first().json.html_divs.media }}\n              <div style=\"font-size: 12px; color: #6c757d; line-height: 1.3;\">Vulnerabilidades de Media Criticidad</div>\n            </td>\n            <td align=\"center\"\n              style=\"width: 25%; padding: 0 5px; text-align: center; vertical-align: top; font-family: Arial, Helvetica, sans-serif;\">\n              {{ $('Code').first().json.html_divs.baja }}\n              <div style=\"font-size: 12px; color: #6c757d; line-height: 1.3;\">Vulnerabilidades de Baja Criticidad</div>\n            </td>\n            <td align=\"center\"\n              style=\"width: 25%; padding: 0 5px; text-align: center; vertical-align: top; font-family: Arial, Helvetica, sans-serif;\">\n              {{ $('Code').first().json.html_divs.total }}\n              <div style=\"font-size: 12px; color: #6c757d; line-height: 1.3;\">Total de Vulnerabilidades</div>\n            </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n    {{ $('Create HTML Table').first().json.output }}\n    <tr>\n      <td class=\"general-guidelines-header\"\n        style=\"padding: 12px 20px; font-size: 18px; font-weight: bold; color: #ffffff; background-color: #005A9C;\">\n        PAUTAS DE ACCI√ìN GENERALES\n      </td>\n    </tr>\n    <tr>\n      <td class=\"general-guidelines\"\n        style=\"padding: 15px 20px; background-color: #f8f9fa; font-size: 14px; line-height: 1.6; color: #333333;\">\n        <ul style=\"margin: 0; padding-left: 20px;\">\n          <li style=\"margin-bottom: 8px;\">Mantener actualizados los sistemas y aplicaciones con los √∫ltimos parches de\n            seguridad.</li>\n          <li style=\"margin-bottom: 8px;\">Implementar medidas de seguridad de red, como firewalls y sistemas de\n            detecci√≥n de intrusos.</li>\n          <li style=\"margin-bottom: 8px;\">Realizar auditor√≠as de seguridad regulares para identificar vulnerabilidades.\n          </li>\n          <li style=\"margin-bottom: 4px;\">Capacitar al personal en seguridad inform√°tica y concienciar sobre los\n            riesgos.</li>\n        </ul>\n      </td>\n    </tr>\n\n  <tr>\n    <td class=\"footer\"\n      style=\"background-color: #343a40; color: #adb5bd; padding: 20px; text-align: center; font-size: 12px;\">\n      Este es un bolet√≠n informativo de ciberseguridad.<br />\n      &copy; 2025 IFX Networks. Todos los derechos reservados.<br />\n      Para consultas, escribe a <a href=\"mailto:soc-cl@ifxcorp.com\"\n        style=\"color: #0099cc; text-decoration: underline;\">soc-cl@ifxcorp.com</a>.<br />\n      Contenido autogenerado por <span\n        style=\"font-style: italic; font-family: 'Arial', sans-serif; color: #ff00ff;\">aifx</span>.\n    </td>\n  </tr>\n  </table>\n</body>\n\n</html>"},"type":"n8n-nodes-base.html","typeVersion":1.2,"position":[1300,60],"id":"8789bef7-a30c-4069-8fba-12605bf476e4","name":"HTML"},{"parameters":{"jsCode":"// Funci√≥n para n8n - Contador de Vulnerabilidades por Severidad\n// Esta funci√≥n analiza el JSON de entrada y cuenta vulnerabilidades por nivel\n\n// Funci√≥n principal que procesa los datos de entrada\nfunction contarVulnerabilidades() {\n    // Obtener los datos del nodo 'Clean Information'\n    const inputData = $('Clean Information').first().json.output;\n    \n    // Inicializar contadores\n    let contadores = {\n        alta: 0,\n        media: 0,\n        baja: 0,\n        total: 0\n    };\n    \n    // Contar vulnerabilidades altas\n    if (inputData.vulnerabilidades_alta && Array.isArray(inputData.vulnerabilidades_alta)) {\n        contadores.alta = inputData.vulnerabilidades_alta.length;\n    }\n    \n    // Contar vulnerabilidades medias\n    if (inputData.vulnerabilidades_media && Array.isArray(inputData.vulnerabilidades_media)) {\n        contadores.media = inputData.vulnerabilidades_media.length;\n    }\n    \n    // Contar vulnerabilidades bajas\n    if (inputData.vulnerabilidades_baja && Array.isArray(inputData.vulnerabilidades_baja)) {\n        contadores.baja = inputData.vulnerabilidades_baja.length;\n    }\n    \n    // Calcular total\n    contadores.total = contadores.alta + contadores.media + contadores.baja;\n    \n    // Crear resumen con HTML divs para cada nivel\n    const resumen = {\n        conteo: contadores,\n        html_divs: {\n            alta: `<div style=\"font-size: 30px; font-weight: bold; color: #d9534f; margin-bottom: 5px; line-height: 1;\">${contadores.alta}</div>`,\n            media: `<div style=\"font-size: 30px; font-weight: bold; color: #f0ad4e; margin-bottom: 5px; line-height: 1;\">${contadores.media}</div>`,\n            baja: `<div style=\"font-size: 30px; font-weight: bold; color: #5cb85c; margin-bottom: 5px; line-height: 1;\">${contadores.baja}</div>`,\n            total: `<div style=\"font-size: 30px; font-weight: bold; color: #007bff; margin-bottom: 5px; line-height: 1;\">${contadores.total}</div>`\n        },\n        resumen_textual: `Se encontraron ${contadores.total} vulnerabilidades: ${contadores.alta} altas, ${contadores.media} medias y ${contadores.baja} bajas.`,\n        fecha_analisis: new Date().toISOString(),\n        nivel_riesgo: determinarNivelRiesgo(contadores)\n    };\n    \n    return [{ json: resumen }];\n}\n\n// Funci√≥n auxiliar para determinar el nivel de riesgo general\nfunction determinarNivelRiesgo(contadores) {\n    if (contadores.alta > 0) {\n        return 'CR√çTICO';\n    } else if (contadores.media > 5) {\n        return 'ALTO';\n    } else if (contadores.media > 0) {\n        return 'MEDIO';\n    } else if (contadores.baja > 0) {\n        return 'BAJO';\n    } else {\n        return 'SIN_VULNERABILIDADES';\n    }\n}\n\n// Funci√≥n alternativa m√°s detallada que incluye informaci√≥n adicional\nfunction contarVulnerabilidadesDetallado() {\n    const inputData = $input.all();\n    \n    let contadores = {\n        alta: 0,\n        media: 0,\n        baja: 0,\n        total: 0\n    };\n    \n    let detalles = {\n        vulnerabilidades_por_fabricante: {},\n        cves_por_nivel: {\n            alta: [],\n            media: [],\n            baja: []\n        },\n        productos_afectados: new Set()\n    };\n    \n    // Procesar cada item de entrada\n    for (const item of inputData) {\n        const data = item.json;\n        \n        // Verificar si los datos est√°n dentro de 'output'\n        const vulnerabilidadData = data.output || data;\n        \n        // Procesar vulnerabilidades altas\n        if (vulnerabilidadData.vulnerabilidades_alta && Array.isArray(vulnerabilidadData.vulnerabilidades_alta)) {\n            contadores.alta += vulnerabilidadData.vulnerabilidades_alta.length;\n            vulnerabilidadData.vulnerabilidades_alta.forEach(vuln => {\n                procesarVulnerabilidad(vuln, 'alta', detalles);\n            });\n        }\n        \n        // Procesar vulnerabilidades medias\n        if (vulnerabilidadData.vulnerabilidades_media && Array.isArray(vulnerabilidadData.vulnerabilidades_media)) {\n            contadores.media += vulnerabilidadData.vulnerabilidades_media.length;\n            vulnerabilidadData.vulnerabilidades_media.forEach(vuln => {\n                procesarVulnerabilidad(vuln, 'media', detalles);\n            });\n        }\n        \n        // Procesar vulnerabilidades bajas\n        if (vulnerabilidadData.vulnerabilidades_baja && Array.isArray(vulnerabilidadData.vulnerabilidades_baja)) {\n            contadores.baja += vulnerabilidadData.vulnerabilidades_baja.length;\n            vulnerabilidadData.vulnerabilidades_baja.forEach(vuln => {\n                procesarVulnerabilidad(vuln, 'baja', detalles);\n            });\n        }\n    }\n    \n    contadores.total = contadores.alta + contadores.media + contadores.baja;\n    \n    // Preparar resultado final\n    const resultado = {\n        conteo: contadores,\n        porcentajes: {\n            alta: contadores.total > 0 ? Math.round((contadores.alta / contadores.total) * 100) : 0,\n            media: contadores.total > 0 ? Math.round((contadores.media / contadores.total) * 100) : 0,\n            baja: contadores.total > 0 ? Math.round((contadores.baja / contadores.total) * 100) : 0\n        },\n        detalles: {\n            ...detalles,\n            productos_afectados: Array.from(detalles.productos_afectados),\n            fabricantes_con_mas_vulnerabilidades: obtenerTopFabricantes(detalles.vulnerabilidades_por_fabricante)\n        },\n        nivel_riesgo: determinarNivelRiesgo(contadores),\n        fecha_analisis: new Date().toISOString()\n    };\n    \n    return [{ json: resultado }];\n}\n\n// Funci√≥n auxiliar para procesar cada vulnerabilidad individualmente\nfunction procesarVulnerabilidad(vuln, nivel, detalles) {\n    if (vuln.fabricante) {\n        if (!detalles.vulnerabilidades_por_fabricante[vuln.fabricante]) {\n            detalles.vulnerabilidades_por_fabricante[vuln.fabricante] = { alta: 0, media: 0, baja: 0 };\n        }\n        detalles.vulnerabilidades_por_fabricante[vuln.fabricante][nivel]++;\n    }\n    \n    if (vuln.cve) {\n        detalles.cves_por_nivel[nivel].push(vuln.cve);\n    }\n    \n    if (vuln.producto) {\n        detalles.productos_afectados.add(vuln.producto);\n    }\n}\n\n// Funci√≥n auxiliar para obtener los fabricantes con m√°s vulnerabilidades\nfunction obtenerTopFabricantes(fabricantes) {\n    return Object.entries(fabricantes)\n        .map(([fabricante, conteos]) => ({\n            fabricante,\n            total: conteos.alta + conteos.media + conteos.baja,\n            desglose: conteos\n        }))\n        .sort((a, b) => b.total - a.total)\n        .slice(0, 5);\n}\n\n// Exportar la funci√≥n principal (usar una de las dos funciones seg√∫n necesidad)\nreturn contarVulnerabilidades(); // Para an√°lisis b√°sico\n// return contarVulnerabilidadesDetallado(); // Para an√°lisis detallado"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[960,40],"id":"6fcefc35-c8c5-41e7-a3ec-2cb105342455","name":"Code","alwaysOutputData":true},{"parameters":{"model":{"__rl":true,"value":"openai-nano","mode":"list","cachedResultName":"openai-nano"},"options":{"temperature":0.3}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[560,300],"id":"51fe16a7-450c-479f-a8f0-be4141f52f35","name":"OpenAI Chat Model1","credentials":{"openAiApi":{"id":"3ksygUY2AafRzzfk","name":"Proxy LiteLLM"}}},{"parameters":{"promptType":"define","text":"={{ $json.data }}","hasOutputParser":true,"options":{"systemMessage":"ERES UN EXPERTO ANALISTA DE CIBERSEGURIDAD Y TU FUNCI√ìN PRINCIPAL ES ANALIZAR, CLASIFICAR Y RESUMIR REPORTES DE VULNERABILIDADES OBTENIDOS A TRAV√âS DE LA **VULNERS.COM**. TU SALIDA DEBE ESTAR ESTRICTAMENTE EN FORMATO JSON Y CUMPLIR CON LA ESTRUCTURA DEFINIDA A CONTINUACI√ìN.\n\n---\n\n### ENCABEZADO OBLIGATORIO ###\nINCLUYE SIEMPRE AL INICIO DE CADA INFORME LA SIGUIENTE L√çNEA EN NEGRITA:\n\n**FUENTE DEL REPORTE: VULNERS.COM**\n\n---\n\n### INSTRUCCIONES DE SALIDA ###\n\n1. **CLASIFICA** CADA VULNERABILIDAD CONFORME A SU CVSS SEG√öN LOS SIGUIENTES RANGOS:\n   - üî¥ CVSS >= 7.0 ‚Üí **CRITICIDAD ALTA**\n   - üü† 5.0 <= CVSS < 7.0 ‚Üí **CRITICIDAD MEDIA**\n   - üü¢ CVSS < 5.0 ‚Üí **CRITICIDAD BAJA**\n\n2. PARA CADA VULNERABILIDAD EXTRAIDA DE VULNERS.COM DEBES PRESENTAR LOS SIGUIENTES CAMPOS:\n   - **Fabricante**\n   - **CVE**\n   - **Fecha del Reporte**\n   - **Producto Afectado**\n   - **CVSS**\n   - **Descripci√≥n T√©cnica**\n   - **Acciones Recomendadas** (clave: `\"acciones\"`)\n   - **Referencias** (texto plano, sin formato)\n\n### CHAIN OF THOUGHTS ###\nSIGUE ESTE FLUJO L√ìGICO ANTES DE GENERAR LA SALIDA:\n\n1. **ENTENDER**: LEER Y COMPRENDER LOS DATOS DE LA API DE VULNERS.\n2. **IDENTIFICAR**: EXTRAER LOS CAMPOS CLAVE DE CADA VULNERABILIDAD.\n3. **CLASIFICAR**: DETERMINAR LA CRITICIDAD BASADA EN CVSS.\n4. **ANALIZAR**: INTERPRETAR DETALLES T√âCNICOS Y CONTEXTO DEL VULNERABLE.\n5. **SINTETIZAR**: REDACTAR DESCRIPCIONES Y ACCIONES √öTILES EN ESPA√ëOL.\n6. **ESTRUCTURAR**: ORGANIZAR LA INFORMACI√ìN EN EL FORMATO JSON AGRUPADO POR CRITICIDAD.\n7. **VALIDAR**: ASEGURARSE DE QUE NO FALTEN CAMPOS NI FORMATO.\n\n---\n\n### WHAT NOT TO DO ###\n- **NO CLASIFIQUES INCORRECTAMENTE SEG√öN EL CVSS**\n- **NO AGRUPES VULNERABILIDADES DE DISTINTA CRITICIDAD EN EL MISMO ARRAY**\n- **NO OMITAS CAMPOS COMO CVSS, FECHA O FABRICANTE**\n- **NO USES LA CLAVE \"acciones_recomendadas\", SOLO \"acciones\"**\n- **NO MODIFIQUES LA ESTRUCTURA JSON DEFINIDA**\n- **NO A√ëADAS TEXTO, COMENTARIOS NI EXPLICACIONES FUERA DEL JSON**\n- **NO INCLUYAS CAMPOS VAC√çOS O LISTAS VAC√çAS**\n- **NO FORMATEES LAS REFERENCIAS COMO LINKS O ENLACES MARKDOWN**"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[100,-20],"id":"3f40d90f-37ce-4af3-98b0-478fa6fc24c6","name":"Clean Information"},{"parameters":{"model":{"__rl":true,"value":"llama-4-Scout","mode":"list","cachedResultName":"llama-4-Scout"},"options":{"temperature":0.3}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[160,340],"id":"e6b54800-847e-4336-86f7-54e849f3e6f7","name":"Llama 4 Parse Data","credentials":{"openAiApi":{"id":"3ksygUY2AafRzzfk","name":"Proxy LiteLLM"}}},{"parameters":{"promptType":"define","text":"={{ $json.output }}","options":{"systemMessage":"ERES UN CONVERSOR HTML ESPECIALIZADO EN INFORMES DE CIBERSEGURIDAD. TU TAREA ES CONVERTIR UN JSON CON VULNERABILIDADES EN BLOQUES DE HTML **DENTRO DE UNA PLANTILLA EXACTA Y ESTRICTA**, MANTENIENDO TODOS LOS ESTILOS Y ESTRUCTURAS FIJOS. **NO DEBES CAMBIAR NI MODIFICAR EL DISE√ëO**, SOLO **AGREGAR NUEVAS FILAS `<tr>`** EN FUNCI√ìN DEL CONTENIDO DEL JSON DE ENTRADA.\n\n###INSTRUCCIONES###\n\n1. DEBES UTILIZAR EL FORMATO EXACTO QUE SE MUESTRA EN EL SIGUIENTE HTML DE REFERENCIA:\n```html\n<tr class=\"criticality-high\">\n  <td class=\"vuln-section-header\"\n    style=\"padding: 12px 20px; font-size: 18px; font-weight: bold; color: #ffffff; background-color: #d9534f;\">\n    CRITICIDAD ALTA\n  </td>\n</tr>\n<tr>\n  <td class=\"vuln-item\" style=\"padding: 15px 20px; border-bottom: 1px solid #e0e0e0;\">\n    <table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n      <tr>\n        <td class=\"label\" style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #003366; font-weight: bold; width: 150px;\">Fabricante:</td>\n        <td style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #333333;\">Broadcom</td>\n      </tr>\n      <tr>\n        <td class=\"label\" style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #003366; font-weight: bold; width: 150px;\">CVE:</td>\n        <td style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #333333;\">N/A</td>\n      </tr>\n      <tr>\n        <td class=\"label\" style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #003366; font-weight: bold; width: 150px;\">Fecha Reporte:</td>\n        <td style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #333333;\">2025-10-04</td>\n      </tr>\n      <tr>\n        <td class=\"label\" style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #003366; font-weight: bold; width: 150px;\">Producto:</td>\n        <td style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #333333;\">P225p NetXtreme-E Dual-port 10Gb/25Gb Ethernet PCIe Adapter</td>\n      </tr>\n      <tr>\n        <td class=\"label\" style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #003366; font-weight: bold; width: 150px;\">CVSS:</td>\n        <td style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #333333;\">\n          <span class=\"cvss-score cvss-high\" style=\"font-weight: bold; padding: 3px 6px; border-radius: 4px; color: #ffffff; display: inline-block; background-color: #c9302c;\">9</span>\n        </td>\n      </tr>\n      <tr>\n        <td class=\"label\" style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #003366; font-weight: bold; width: 150px;\">Descripci√≥n:</td>\n        <td style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #333333;\">Texto completo de la descripci√≥n‚Ä¶</td>\n      </tr>\n      <tr>\n        <td class=\"label\" style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #003366; font-weight: bold; width: 150px;\">Acciones:</td>\n        <td style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #333333;\">\n          <div class=\"recommendations\" style=\"margin-top: 8px;\">\n            <ul style=\"margin: 5px 0 0 0; padding-left: 20px;\">\n              <li style=\"margin-bottom: 4px;\">Texto de la acci√≥n</li>\n            </ul>\n          </div>\n        </td>\n      </tr>\n      <tr>\n        <td class=\"label\" style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #003366; font-weight: bold; width: 150px;\">Referencias:</td>\n        <td style=\"padding: 6px 0; font-size: 14px; line-height: 1.6; color: #333333;\">\n          <a href=\"https://enlace.com/referencia\" style=\"color: #007bff; text-decoration: none;\">https://enlace.com/referencia</a>\n        </td>\n      </tr>\n    </table>\n  </td>\n</tr>\n```\n\n2. DEBES REPLICAR ESTE FORMATO PARA CADA VULNERABILIDAD PRESENTE EN EL JSON. USA:\n\n- `class=\"criticality-high\"` para ALTA con color `#d9534f`\n- `class=\"criticality-medium\"` para MEDIA con color `#f0ad4e`\n- `class=\"criticality-low\"` para BAJA con color `#5bc0de`\n\n3. MUESTRA SIEMPRE TODAS LAS VULNERABILIDADES. NO RESUMAS. NO AGRUPES. NO OMITAS.\n\n4. EL CAMPO **CVSS** SE RENDERIZA CON ESTILO:\n   - `.cvss-high` si ‚â• 7 (`background-color: #c9302c`)\n   - `.cvss-medium` si ‚â• 4 y < 7 (`background-color: #f0ad4e`)\n   - `.cvss-low` si < 4 (`background-color: #5bc0de`)\n\n###CHAIN OF THOUGHTS###\n\n1. **UNDERSTAND** el esquema del JSON con sus listas por criticidad\n2. **BASICS**: Mapear `vulnerabilidades_alta`, `media`, `baja`\n3. **BREAK DOWN** cada objeto en sus componentes: fabricante, cve, producto, etc.\n4. **ANALYZE** cada valor y convertirlo en tabla HTML con el formato fijo\n5. **BUILD** los bloques `<tr>` por criticidad\n6. **EDGE CASES**: valores de CVSS = 0, CVE faltante, m√∫ltiples acciones o referencias\n7. **FINAL ANSWER**: generar solo los `<tr>` completos que correspondan, listos para insertar en un HTML mayor\n8. **`referencias`**: mostrar el enlace en crudo, sin renombrar ni resumir.  \n     EJEMPLO CORRECTO:\n     ```html <a href=\"https://access.redhat.com/security/cve/cve-2025-33138\" style=\"color: #007bff; text-decoration: none;\">https://access.redhat.com/security/cve/cve-2025-33138</a>\n```\n\n###WHAT NOT TO DO###\n\n- **NO CAMBIES LOS COLORES, FUENTES O CLASES CSS**\n- **NO OMITAS VULNERABILIDADES AUN SI TIENEN CVSS 0 O SIN CVE**\n- **NO INSERTES TEXTO FUERA DE LOS BLOQUES HTML**\n- **NO RESUMAS NI MODIFIQUES LA DESCRIPCI√ìN NI LISTAS**\n- **NO CAMBIES EL ORDEN DE LOS CAMPOS**\n- **NO AGRUPES VULNERABILIDADES**\n- **NO CAMBIES LOS LINKS: MUESTRA EL URL COMPLETO COMO TEXTO VISIBLE**\n- **NO RENOMBRES ENLACES COMO ‚Äúreferencia‚Äù O ‚Äúenlace‚Äù**\n\n\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.9,"position":[560,80],"id":"32486aa4-5547-4796-a96a-5863dcc9c5c5","name":"Create HTML Table"}],"connections":{"HTTP Request":{"main":[[{"node":"Clean Information","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"When clicking ‚ÄòTest workflow‚Äô":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"Llama 4 Scout":{"ai_languageModel":[[{"node":"Clean Information","type":"ai_languageModel","index":0}]]},"Auto-fixing Output Parser":{"ai_outputParser":[[{"node":"Clean Information","type":"ai_outputParser","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Auto-fixing Output Parser","type":"ai_outputParser","index":0}]]},"HTML":{"main":[[]]},"Code":{"main":[[{"node":"HTML","type":"main","index":0}]]},"Test Mail jaimep@ifxcorp.com":{"main":[[]]},"OpenAI Chat Model1":{"ai_languageModel":[[{"node":"Create HTML Table","type":"ai_languageModel","index":0}]]},"Clean Information":{"main":[[{"node":"Create HTML Table","type":"main","index":0}]]},"Llama 4 Parse Data":{"ai_languageModel":[[{"node":"Auto-fixing Output Parser","type":"ai_languageModel","index":0}]]},"Create HTML Table":{"main":[[{"node":"Code","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","errorWorkflow":"Txht1wrdLAI370JY","timezone":"America/Bogota"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"37148677-a67f-4cf3-9be7-03fe8a607b25","triggerCount":1,"tags":[]}