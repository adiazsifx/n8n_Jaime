{"createdAt":"2025-06-02T13:10:04.234Z","updatedAt":"2025-06-02T13:58:38.000Z","id":"qfn8buLdLlpCTmis","name":"Check DB n8n Size","active":true,"isArchived":false,"nodes":[{"parameters":{"jsCode":"const output = $input.first().json.stdout;\nconst parts = output.split(/\\s+/);\n\nconst day = parts[6].padStart(2, '0');\nconst monthName = parts[5];\nconst year = new Date().getFullYear();\n\n// Soporte para MB y GB\nlet sizeValue = parseFloat(parts[4]);\nconst sizeUnit = parts[4].slice(-1);\nconst size_mb = sizeUnit === 'G' ? sizeValue * 1024 : sizeValue;\n\nreturn {\n permissions: parts[0],\n owner: parts[2],\n group: parts[3],\n size: parts[4],\n path: parts[8],\n size_mb: size_mb,\n date: `${day}-${monthName}-${year}`,\n filename: parts[8].split('/').pop()\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[520,0],"id":"24882b3d-441a-4a90-8975-4c4afc17d2ec","name":"Code"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"08b04ddb-d086-49b8-9cea-e9f66cda219b","leftValue":"={{ $json.size_mb }}","rightValue":3000,"operator":{"type":"number","operation":"gt"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[680,0],"id":"62ca26ab-e7d5-46ca-abdb-f362dab85cb0","name":"If"},{"parameters":{"resource":"messages-api","instanceName":"whisper_aifx","remoteJid":"573165278069","messageText":"=‚ö†Ô∏è *SEGUIMIENTO TAMA√ëO DB N8N*\nüìÇ  Archivo: {{ $json.path }}\nüóìÔ∏è Fecha:  {{ $json.date }}\nüíæ Tama√±o de DB: {{ $json.size }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[920,80],"id":"04ead7dd-fdf5-4b27-b44d-72b0218bc06d","name":"Seguimiento Size","credentials":{"evolutionApi":{"id":"9k6KTcMvpINN4jXM","name":"Evolution aifx 3171057858"}}},{"parameters":{"resource":"messages-api","instanceName":"whisper_aifx","remoteJid":"573165278069","messageText":"=üö® *ALERTA DB N8N*\nüìä  Archivo: {{ $json.path }}\nüóìÔ∏è Fecha:  {{ $json.date }}\nüíæ Tama√±o de DB: {{ $json.size }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[920,-100],"id":"68fc7ac9-ceb6-4b0c-8c97-2d57c5a2d549","name":"Alerta Size","credentials":{"evolutionApi":{"id":"9k6KTcMvpINN4jXM","name":"Evolution aifx 3171057858"}}},{"parameters":{"rule":{"interval":[{"triggerAtHour":9}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[160,0],"id":"dbe719d1-415a-4041-8e09-3237d7f054f7","name":"Schedule Trigger"},{"parameters":{"command":"ls -lh /home/node/.n8n/database.sqlite"},"type":"n8n-nodes-base.executeCommand","typeVersion":1,"position":[360,0],"id":"16ca5d44-480b-43c6-ac73-0361bb09829a","name":"Check Size"},{"parameters":{"jsCode":"const output = $input.first().json.stdout;\nconst parts = output.split(/\\s+/);\n\nconst day = parts[6].padStart(2, '0');\nconst monthName = parts[5];\nconst year = new Date().getFullYear();\n\n// Soporte para MB y GB\nlet sizeValue = parseFloat(parts[4]);\nconst sizeUnit = parts[4].slice(-1);\nconst size_mb = sizeUnit === 'G' ? sizeValue * 1024 : sizeValue;\n\nreturn {\n permissions: parts[0],\n owner: parts[2],\n group: parts[3],\n size: parts[4],\n path: parts[8],\n size_mb: size_mb,\n date: `${day}-${monthName}-${year}`,\n filename: parts[8].split('/').pop()\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[540,380],"id":"80966e01-79d5-40d7-a78d-165395f75b21","name":"Code1"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"08b04ddb-d086-49b8-9cea-e9f66cda219b","leftValue":"={{ $json.size_mb }}","rightValue":3000,"operator":{"type":"number","operation":"gt"}}],"combinator":"and"},"looseTypeValidation":true,"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[700,380],"id":"f385cd38-d8c5-4a76-a5b8-26de9943b06c","name":"If1"},{"parameters":{"resource":"messages-api","instanceName":"whisper_aifx","remoteJid":"573165278069","messageText":"=üö® *ALERTA DB N8N*\nüìä  Archivo: {{ $json.path }}\nüóìÔ∏è Fecha:  {{ $json.date }}\nüíæ Tama√±o de DB: {{ $json.size }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[920,280],"id":"2e3157d7-463f-45e6-8799-7a86bcc24ab7","name":"Alerta Size1","credentials":{"evolutionApi":{"id":"9k6KTcMvpINN4jXM","name":"Evolution aifx 3171057858"}}},{"parameters":{"rule":{"interval":[{"triggerAtHour":9},{"field":"hours"}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[180,380],"id":"11a788fe-2ea5-4624-9501-e1cb76cc80ee","name":"Schedule Trigger1"},{"parameters":{"command":"ls -lh /home/node/.n8n/database.sqlite"},"type":"n8n-nodes-base.executeCommand","typeVersion":1,"position":[380,380],"id":"0b8038bf-9993-47ab-961a-84a69b87995e","name":"Check Size1"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[920,480],"id":"8f656cf5-1115-441a-924f-070e09c4559b","name":"do nothing"}],"connections":{"Code":{"main":[[{"node":"If","type":"main","index":0}]]},"If":{"main":[[{"node":"Alerta Size","type":"main","index":0}],[{"node":"Seguimiento Size","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Check Size","type":"main","index":0}]]},"Check Size":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code1":{"main":[[{"node":"If1","type":"main","index":0}]]},"If1":{"main":[[{"node":"Alerta Size1","type":"main","index":0}],[{"node":"do nothing","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[{"node":"Check Size1","type":"main","index":0}]]},"Check Size1":{"main":[[{"node":"Code1","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","timezone":"America/Bogota","callerPolicy":"workflowsFromSameOwner","executionTimeout":300,"errorWorkflow":"Txht1wrdLAI370JY","timeSavedPerExecution":30},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]},"node:Schedule Trigger1":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"9af5bab2-9700-4037-91c8-21de5e90e64d","triggerCount":2,"tags":[]}