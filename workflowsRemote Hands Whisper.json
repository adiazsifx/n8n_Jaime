{"createdAt":"2025-06-16T16:58:43.021Z","updatedAt":"2025-06-22T00:50:35.000Z","id":"EqwGgiPgMP5zpDaW","name":"Remote Hands Whisper","active":true,"isArchived":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"whisper_remote_hands","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-920,240],"id":"1e2d51a8-bc24-45a4-81f1-c0dffb24c056","name":"Webhook","webhookId":"69fc8c2e-039d-4679-a583-08f892948ec2"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.body.data.message.conversation }}","rightValue":"INGRESO VISITA","operator":{"type":"string","operation":"contains"},"id":"7bafa925-76bc-4d9a-826f-bc5e43714a7c"}],"combinator":"and"},"renameOutput":true,"outputKey":"INGRESO"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"90b50ac9-f5cb-4dd4-b67a-c240309574c1","leftValue":"={{ $json.body.data.message.conversation }}","rightValue":"SALIDA VISITA","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"SALIDA"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"35338151-0c7f-49e1-b347-e4a2b778e36c","leftValue":"={{ $json.body.data.message.conversation }}","rightValue":"SOLICITUD MANOS REMOTAS","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"SOLICITUD"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cb2ac066-e851-4699-a841-f9b986d8d581","leftValue":"={{ $json.body.data.message.conversation }}","rightValue":"\"INGRESO VISITA\" \"SALIDA VISITA\" \"SOLICITUD MANOS REMOTAS\"","operator":{"type":"string","operation":"notContains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"OTROS"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[-580,220],"id":"16214f2a-f690-4765-96a0-d606e559954f","name":"Switch"},{"parameters":{"text":"={{ $json.body.data.message.conversation }}","schemaType":"fromJson","jsonSchemaExample":"{\n  \"plantilla\": \"INGRESO VISITA MANOS REMOTAS\",\n  \"descripcion\": \"INGRESO\",\n  \"cliente\": \"OMEGA HEALTHCARE COLOMBIA SAS\",\n  \"direccion_cliente\": \"CARRERA 106 # 15 A - 25 / MANZANA 18\",\n  \"ciudad\": \"BOGOTA - ZONA FRANCA DE BOGOTA\",\n  \"sid\": \"2110817 - SID2262254\",\n  \"ticket\": \"1075018\",\n  \"hora_ingreso\": \"13:58\",\n  \"nombre_tecnico\": \"MIGUEL FEO\",\n  \"celular_tecnico\": \"3018147574\"\n}\n","options":{}},"type":"@n8n/n8n-nodes-langchain.informationExtractor","typeVersion":1.2,"position":[-220,20],"id":"8f15a2a1-714d-436a-9c2f-808fabf4bf23","name":"Extraer Datos Ingreso","alwaysOutputData":true},{"parameters":{"text":"={{ $json.body.data.message.conversation }}","schemaType":"fromJson","jsonSchemaExample":"{\n  \"plantilla\": \"SALIDA VISITAS MANOS REMOTAS\",\n  \"descripcion\": \"SALIDA\",\n  \"cliente\": \"BETA NETWORKS LTDA.\",\n  \"direccion_cliente\": \"CALLE 120 # 7-90, MEDELLIN\",\n  \"sid\": \"1234567\",\n  \"ticket\": \"TT123456\",\n  \"hora_salida\": \"14:10\",\n  \"estado_servicio\": \"NO OPERATIVO\",\n  \"visita_fallida\": \"SI\",\n  \"razon_fallida\": \"PERMISOS DE INGRESO\"\n}\n","options":{}},"type":"@n8n/n8n-nodes-langchain.informationExtractor","typeVersion":1.2,"position":[-220,220],"id":"f039d950-f828-4e36-a691-974c8b6d55ab","name":"Extraer Datos Salida","alwaysOutputData":true},{"parameters":{"assignments":{"assignments":[{"id":"c1dcebc9-7edf-4f1f-bb4c-0f8e969adc92","name":"id_chat","value":"={{ $json.body.data.key.id }}","type":"string"},{"id":"99c0cf5b-715f-476a-b544-a59bda68dd58","name":"remoteJid","value":"={{ $json.body.data.key.remoteJid }}","type":"string"},{"id":"f079ba3e-db2c-401a-adfd-be7b5570bc64","name":"participant","value":"={{ $json.body.data.key.participant }}","type":"string"},{"id":"c4aef7e1-3a9c-4a8d-91b0-30d9455f0175","name":"body.data.pushName","value":"={{ $json.body.data.pushName }}","type":"string"},{"id":"991fcd2b-0179-489d-8d1c-20cf5d44c2b9","name":"conversation","value":"={{ $json.body.data.message.conversation }}","type":"string"},{"id":"de27a3de-1682-4869-9f33-cf69485956c3","name":"instance_id","value":"={{ $json.body.data.instanceId }}","type":"string"},{"id":"3cbc8371-e23b-4d71-9db8-87a7c6b1d8ad","name":"body.sender","value":"={{ $json.body.sender }}","type":"string"},{"id":"754e47e5-2947-4123-8396-bfe942af3ca1","name":"url_image","value":"={{ $json.body.data.message.imageMessage.url }}","type":"string"},{"id":"d2fbd034-502c-4f3f-8b6d-306c75ace263","name":"url_audio","value":"={{ $json.body.data.message.audioMessage.url }}","type":"string"},{"id":"63e8158b-6960-4864-989c-17923de1a8a7","name":"url_video","value":"={{ $json.body.data.message.videoMessage.url }}","type":"string"},{"id":"a73894d6-0b44-4b06-9210-9e6b28bd83d5","name":"nombrechat","value":"={{ $json.data.subject }}","type":"string"},{"id":"bb914c09-3de2-4a09-a771-1201ae97b22d","name":"body.date_time","value":"={{ $json.body.date_time }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-220,600],"id":"44dfca75-938b-46ff-8924-803217c2b35e","name":"Edit Fields"},{"parameters":{"model":{"__rl":true,"value":"llama-8B-Instruct","mode":"list","cachedResultName":"llama-8B-Instruct"},"options":{"temperature":0.3}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-520,500],"id":"e8f4be5e-6bb5-4b1a-aca7-8177bff994d6","name":"Llama 3.1 8B","credentials":{"openAiApi":{"id":"3ksygUY2AafRzzfk","name":"Proxy LiteLLM"}}},{"parameters":{"text":"={{ $json.body.data.message.conversation }}","schemaType":"fromJson","jsonSchemaExample":"{\n  \"asunto\": \"Solicitud manos remotas URBMAN PANAMA S.A. : YEYO S.A.\",\n  \"descripcion_solicitud\": \"TRASLADO\",\n\"tipo_mantenimiento_implementacion\": \"IMPLEMENTACIÓN\",\n  \"acta_UM_adjunta\": \"NO\",\n  \"cliente\": \"URBMAN PANAMA S.A. : YEYO S.A.\",\n  \"pais\": \"GUATEMALA\",\n  \"ciudad\": \"Carretera a El Salvador Guatemala\",\n  \"direccion_cliente\": \"Hacienda San Miguel de Arrazola, Carr. A El Salvador Guatemala\",\n  \"coordenadas\": \"14.53775, -90.45678\",\n  \"fecha\": \"26-jun-25\",\n  \"hora\": \"13:10\",\n  \"ticket\": \"TT12345\",\n  \"sid\": \"1453626\",\n  \"nombre_contacto_cliente\": \"Nery Caballeros\",\n  \"telefono_cliente\": \"502 3569 3407\",\n  \"equipos_a_llevar\": \"2 Routers\",\n  \"rq_equipos\": \"12345\",\n  \"donde_recoger_equipo\": \"Recoger en Almacen Colombia\",\n  \"guia_envio_equipos\": \"Servientrega 12345\",\n  \"ingeniero_aprovisionamiento_responsable\": \"JUAN MONROY\",\n  \"gerente_proyecto\": \"JUAN MONROY\",\n  \"observaciones\": \"Llevar cable de consola, cable de red, conexión de datos móviles y portátil, que el portátil tenga puerto RJ45 de 1Gbps.\"\n}\n","options":{}},"type":"@n8n/n8n-nodes-langchain.informationExtractor","typeVersion":1.2,"position":[-220,420],"id":"630a3f99-ca3b-4050-8861-62d3277ce4af","name":"Extraer Datos Solicitud","alwaysOutputData":true},{"parameters":{"schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"messages","mode":"list","cachedResultName":"messages"},"columns":{"mappingMode":"defineBelow","value":{"id_chat":"={{ $json.id_chat }}","remotejid":"={{ $json.remoteJid }}","participant":"={{ $json.participant }}","pushname":"={{ $json.body.data.pushName }}","conversation":"={{ $json.conversation }}","instanceid":"={{ $json.instance_id }}","url_image":"={{ $json.url_image }}","sender":"={{ $json.body.sender }}","datetime":"={{ $json.body.date_time }}","url_audio":"={{ $json.url_audio }}","url_video":"={{ $json.url_video }}","nombrechat":"={{ $json.nombrechat }}"},"matchingColumns":["id"],"schema":[{"id":"id_chat","displayName":"id_chat","required":true,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"remotejid","displayName":"remotejid","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"participant","displayName":"participant","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"pushname","displayName":"pushname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"conversation","displayName":"conversation","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"instanceid","displayName":"instanceid","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"datetime","displayName":"datetime","required":false,"defaultMatch":false,"display":true,"type":"dateTime","canBeUsedToMatch":true},{"id":"sender","displayName":"sender","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"url_image","displayName":"url_image","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"url_audio","displayName":"url_audio","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"url_video","displayName":"url_video","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"nombrechat","displayName":"nombrechat","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"id","displayName":"id","required":false,"defaultMatch":true,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"nombrecliente","displayName":"nombrecliente","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"real_name_user","displayName":"real_name_user","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[0,600],"id":"ea48394a-8632-46b2-a7d1-4caba194ea10","name":"Insert Messages","credentials":{"postgres":{"id":"brzMaPB6iJB9Pcyc","name":"Postgres DB Operaciones"}}}],"connections":{"Webhook":{"main":[[{"node":"Switch","type":"main","index":0}]]},"Switch":{"main":[[{"node":"Extraer Datos Ingreso","type":"main","index":0}],[{"node":"Extraer Datos Salida","type":"main","index":0}],[{"node":"Extraer Datos Solicitud","type":"main","index":0}],[{"node":"Edit Fields","type":"main","index":0}]]},"Extraer Datos Salida":{"main":[[]]},"Llama 3.1 8B":{"ai_languageModel":[[{"node":"Extraer Datos Ingreso","type":"ai_languageModel","index":0},{"node":"Extraer Datos Salida","type":"ai_languageModel","index":0},{"node":"Extraer Datos Solicitud","type":"ai_languageModel","index":0}]]},"Edit Fields":{"main":[[{"node":"Insert Messages","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","saveDataSuccessExecution":"all","saveExecutionProgress":true,"saveManualExecutions":true,"callerPolicy":"workflowsFromSameOwner"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"41d1bf2a-3aae-4860-bb1a-0ea9ea852fb8","triggerCount":1,"tags":[]}