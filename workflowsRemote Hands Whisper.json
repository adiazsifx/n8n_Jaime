{"createdAt":"2025-06-16T16:58:43.021Z","updatedAt":"2025-06-21T23:08:17.000Z","id":"EqwGgiPgMP5zpDaW","name":"Remote Hands Whisper","active":true,"isArchived":false,"nodes":[{"parameters":{"schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"messages","mode":"list","cachedResultName":"messages"},"columns":{"mappingMode":"defineBelow","value":{"id_chat":"={{ $('Incoming Whisper Wapp').item.json.body.data.key.id }}","remotejid":"={{ $('Incoming Whisper Wapp').item.json.body.data.key.remoteJid }}","participant":"={{ $('Incoming Whisper Wapp').item.json.body.data.key.participant }}","pushname":"={{ $('Incoming Whisper Wapp').item.json.body.data.pushName }}","conversation":"={{ $('Incoming Whisper Wapp').item.json.body.data.message.conversation }}","instanceid":"={{ $('Incoming Whisper Wapp').item.json.body.data.instanceId}}","sender":"={{ $('Incoming Whisper Wapp').item.json.body.sender }}","url_image":"={{ $('Incoming Whisper Wapp').item.json.body.data.message.imageMessage.url }}","url_audio":"={{ $('Incoming Whisper Wapp').item.json.body.data.message.audioMessage.url }}","url_video":"={{ $('Incoming Whisper Wapp').item.json.body.data.message.videoMessage.url }}"},"matchingColumns":["id"],"schema":[{"id":"id_chat","displayName":"id_chat","required":true,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"remotejid","displayName":"remotejid","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"participant","displayName":"participant","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"pushname","displayName":"pushname","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"conversation","displayName":"conversation","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"instanceid","displayName":"instanceid","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"datetime","displayName":"datetime","required":false,"defaultMatch":false,"display":true,"type":"dateTime","canBeUsedToMatch":true,"removed":true},{"id":"sender","displayName":"sender","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"url_image","displayName":"url_image","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"url_audio","displayName":"url_audio","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"url_video","displayName":"url_video","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"nombrechat","displayName":"nombrechat","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"id","displayName":"id","required":false,"defaultMatch":true,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"nombrecliente","displayName":"nombrecliente","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"real_name_user","displayName":"real_name_user","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1060,-60],"id":"b5dbe489-f575-40f7-9415-dac666ecae05","name":"Write DB Remote Hands","credentials":{"postgres":{"id":"brzMaPB6iJB9Pcyc","name":"Postgres DB Operaciones"}}},{"parameters":{"operation":"executeQuery","query":"SELECT EXISTS(\n   SELECT 1 \n   FROM groups_remote_hands \n   WHERE remoteJid = 'tu_remotejid_aqui'\n) AS existe;","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[320,-40],"id":"4589da53-66bc-4048-881c-f4ab0e5094c2","name":"Query Has RemotJid","credentials":{"postgres":{"id":"brzMaPB6iJB9Pcyc","name":"Postgres DB Operaciones"}}},{"parameters":{"operation":"update","schema":{"__rl":true,"mode":"list","value":"public"},"table":{"__rl":true,"value":"groups_remote_hands","mode":"list","cachedResultName":"groups_remote_hands"},"columns":{"mappingMode":"defineBelow","value":{"nombregrupo":"={{ $('SET Group Name').item.json.data.subject }}","remoteJid":"={{ $('SET Group Name').item.json.data.id }}"},"matchingColumns":["nombregrupo"],"schema":[{"id":"id","displayName":"id","required":false,"defaultMatch":true,"display":true,"type":"number","canBeUsedToMatch":true,"removed":true},{"id":"nombregrupo","displayName":"nombregrupo","required":true,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"contratista","displayName":"contratista","required":true,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"description","displayName":"description","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"remoteJid","displayName":"remoteJid","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[820,40],"id":"e2cceaf2-aa35-400a-8d3f-5565209aa5e2","name":"SET RemoteJID","credentials":{"postgres":{"id":"brzMaPB6iJB9Pcyc","name":"Postgres DB Operaciones"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cdfdb44d-4577-4f24-8fee-6b63d59ab70b","leftValue":"={{ $('Query Has RemotJid').item.json.tiene_remotejid }}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[500,-40],"id":"5c0ff47a-7b75-46a2-b670-eaeedf4feac0","name":"Has RemoteJid"},{"parameters":{"httpMethod":"POST","path":"whisper_remote_hands","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-600,-40],"id":"1e2d51a8-bc24-45a4-81f1-c0dffb24c056","name":"Webhook","webhookId":"69fc8c2e-039d-4679-a583-08f892948ec2"},{"parameters":{"text":"={{ $json.body.data.message.conversation }}","schemaType":"fromJson","jsonSchemaExample":"{\n  \"asunto\": \"Solicitud manos remotas URBMAN PANAMA S.A. : YEYO S.A.\",\n  \"descripcion_solicitud\": \"TRASLADO\",\n  \"tipo_mantenimiento_implementacion\": \"IMPLEMENTACIÓN\",\n  \"acta_UM_adjunta\": \"NO\",\n  \"cliente\": \"URBMAN PANAMA S.A. : YEYO S.A.\",\n  \"pais\": \"GUATEMALA\",\n  \"ciudad\": \"Carretera a El Salvador Guatemala\",\n  \"direccion_cliente\": \"Hacienda San Miguel de Arrazola, Carr. A El Salvador Guatemala\",\n  \"coordenadas\": \"14.53775, -90.45678\",\n  \"fecha\": \"26-jun-25\",\n  \"hora\": \"12:00\",\n  \"ticket\": \"N/A\",\n  \"sid\": \"1453626\",\n  \"nombre_contacto_cliente\": \"Nery Caballeros\",\n  \"telefono_cliente\": \"502 3569 3407\",\n  \"equipos_a_llevar\": \"N/A\",\n  \"rq_equipos\": \"N/A\",\n  \"donde_recoger_equipo\": \"N/A\",\n  \"guia_envio_equipos\": \"N/A\",\n  \"ingeniero_aprovisionamiento_responsable\": \"JUAN MONROY\",\n  \"gerente_proyecto\": \"JUAN MONROY\",\n  \"observaciones\": \"Llevar cable de consola, cable de red, conexión de datos móviles y portátil, que el portátil tenga puerto RJ45 de 1Gbps.\"\n}\n","options":{}},"type":"@n8n/n8n-nodes-langchain.informationExtractor","typeVersion":1.2,"position":[-40,-60],"id":"630a3f99-ca3b-4050-8861-62d3277ce4af","name":"Information Extractor","alwaysOutputData":true},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.body.data.message.conversation }}","rightValue":"INGRESO VISITA","operator":{"type":"string","operation":"contains"},"id":"7bafa925-76bc-4d9a-826f-bc5e43714a7c"}],"combinator":"and"},"renameOutput":true,"outputKey":"INGRESO"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"90b50ac9-f5cb-4dd4-b67a-c240309574c1","leftValue":"={{ $json.body.data.message.conversation }}","rightValue":"SALIDA VISITA","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"SALIDA"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"35338151-0c7f-49e1-b347-e4a2b778e36c","leftValue":"={{ $json.body.data.message.conversation }}","rightValue":"SOLICITUD MANOS REMOTAS","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"SOLICITUD"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[-340,-40],"id":"16214f2a-f690-4765-96a0-d606e559954f","name":"Switch"}],"connections":{"Write DB Remote Hands":{"main":[[]]},"Query Has RemotJid":{"main":[[{"node":"Has RemoteJid","type":"main","index":0}]]},"SET RemoteJID":{"main":[[{"node":"Write DB Remote Hands","type":"main","index":0}]]},"Has RemoteJid":{"main":[[{"node":"Write DB Remote Hands","type":"main","index":0}],[{"node":"SET RemoteJID","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"Switch","type":"main","index":0}]]},"Information Extractor":{"main":[[]]},"Switch":{"main":[[],[],[]]}},"settings":{"executionOrder":"v1","saveDataSuccessExecution":"all","saveExecutionProgress":true,"saveManualExecutions":true,"callerPolicy":"workflowsFromSameOwner"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"b773504e-0605-4597-871c-134e9a0729a4","triggerCount":1,"tags":[]}