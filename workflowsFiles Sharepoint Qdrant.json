{"createdAt":"2025-04-29T14:39:10.759Z","updatedAt":"2025-05-12T20:15:02.000Z","id":"OLutAaApcnjH42ow","name":"Files Sharepoint Qdrant","active":true,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-500,0],"id":"357a7dfe-cdf0-4255-ae62-655557658837","name":"When clicking ‘Test workflow’"},{"parameters":{"curlImport":"","httpVariantWarning":"","method":"GET","url":"https://ifxusa.sharepoint.com/_api/web/lists/getbytitle('REPOSITORIO DOCUMENTAL')/items?$select=FileRef,FileLeafRef,File/Length,File/Name,File/TimeLastModified&$expand=File&$filter=FSObjType eq 0 and substringof('/Estrategia/Gestión de Productos y Servicios/', FileRef)&$top=3&$skiptoken=Paged=TRUE&p_ID=3","":"","authentication":"predefinedCredentialType","nodeCredentialType":"microsoftSharePointOAuth2Api","provideSslCertificates":false,"sendQuery":false,"sendHeaders":true,"specifyHeaders":"keypair","headerParameters":{"parameters":[{"name":"Accept","value":"application/json;odata=verbose"}]},"sendBody":false,"options":{},"infoMessage":""},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-280,0],"id":"39781b66-fd61-4997-8aaf-7bfc390c7868","name":"Microsoft SharePoint HTTP Request1","alwaysOutputData":false,"extendsCredential":"microsoftSharePointOAuth2Api","credentials":{"microsoftSharePointOAuth2Api":{"id":"zEGJXJxmWIUvbxbN","name":"Sharepoint IFX JPG"}}},{"parameters":{"jsCode":"const items = $input.first().json.d.results;\nreturn items.map(item => {\n  // Extraer el ID del archivo de la URL\n  const fileId = item.File?.__metadata?.id?.split('(').pop()?.split(')')[0];\n  \n  return {\n    json: {\n      name: item.FileLeafRef,\n      // Usar el formato de API v2.0\n      downloadUrl: `https://ifxusa.sharepoint.com/_api/v2.0/drives/items/${fileId}/content`,\n      graphUrl: `https://ifxusa.sharepoint.com/_api/v2.0/sites/root/drives/items/${item.File?.__metadata?.id}/content`,\n      legacyUrl: `https://ifxusa.sharepoint.com/_api/Web/GetFileByServerRelativeUrl('${item.FileRef}')/$value`,\n      size: item.File?.Length,\n      lastModified: item.File?.TimeLastModified,\n      path: item.FileRef\n    }\n  };\n});"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-80,0],"id":"23c6f224-41b4-44af-bafe-19b0a29b419c","name":"Code"},{"parameters":{"curlImport":"","httpVariantWarning":"","method":"GET","url":"=https://ifxusa.sharepoint.com/_api/web/GetFileByServerRelativeUrl('{{ $json.path }}')/$value","":"","authentication":"predefinedCredentialType","nodeCredentialType":"microsoftSharePointOAuth2Api","provideSslCertificates":false,"sendQuery":false,"sendHeaders":false,"sendBody":false,"options":{"response":{"response":{"fullResponse":false,"neverError":false,"responseFormat":"file","outputPropertyName":"data"}}},"infoMessage":""},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[380,20],"id":"bda1f58d-d1c1-44db-9d15-c996050674fc","name":"Microsoft SharePoint HTTP Request","extendsCredential":"microsoftSharePointOAuth2Api","credentials":{"microsoftSharePointOAuth2Api":{"id":"zEGJXJxmWIUvbxbN","name":"Sharepoint IFX JPG"}}},{"parameters":{"jsCode":"// Mantiene todos los datos incluidos los binarios\nconst item = $input.first();\n\n// No necesitamos acceder a d.results en este punto\nreturn {\n  json: item.json, // Mantén todos los campos JSON originales\n  binary: {\n    data: {\n      ...item.binary.data,\n      fileName: item.json.name,\n      fileExtension: \"bin\",\n      fileType: $('Microsoft SharePoint HTTP Request1').first().json.d.results[0].File.__metadata.type,\n      fileSize: $input.first().json.size,\n      mimeType: \"/application/octet-stream\",\n      // Aquí forzamos el nombre correcto\n    }\n  }\n};"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[520,20],"id":"68777994-e29a-4a07-b39f-0de94707a19d","name":"Code1"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.name }}","rightValue":".pdf","operator":{"type":"string","operation":"contains"},"id":"dd1c7676-17de-4552-a167-9c3d930eec3f"}],"combinator":"and"},"renameOutput":true,"outputKey":"PDF"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"be7305ce-cb0b-406f-a8c2-533ce8c0e3b5","leftValue":"={{ $json.name }}","rightValue":".doc","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"DOC"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"d348e258-6afb-425e-a24c-5ed10ed765da","leftValue":"={{ $json.name }}","rightValue":".docx","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"DOCX"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"44f3ded8-4d12-414f-90b9-32722811570b","leftValue":"={{ $json.name }}","rightValue":".xls","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"XLS"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"9b17eaaf-550b-4548-980c-d1605c0efaac","leftValue":"={{ $json.name }}","rightValue":".xlsx","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"XLSX"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"94a92ff1-f6a1-4d3f-96cd-14434854768c","leftValue":"={{ $json.name }}","rightValue":".ppt","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"PPT"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"bc0bfa79-edc3-493e-8022-2f9d6a5947d8","leftValue":"={{ $json.name }}","rightValue":".pptx","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"PPTX"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"405b331f-8da2-41f4-bc03-e580a1be2c18","leftValue":"={{ $json.name }}","rightValue":".jpg","operator":{"type":"string","operation":"contains"}}],"combinator":"and"},"renameOutput":true,"outputKey":"JPG"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"05828fe5-c537-448e-b273-8c368a542af4","leftValue":"={{ $json.name }}","rightValue":".png","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"PNG"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[700,-100],"id":"ab4dbc90-f5f9-4f29-aafd-13a9aa3031dc","name":"Switch"},{"parameters":{"method":"POST","url":"https://api.cloud.llamaindex.ai/api/v1/parsing/upload","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"parameterType":"formBinaryData","name":"file","inputDataFieldName":"data"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[920,-360],"id":"ca837e87-6499-49aa-9000-5bb4b9c9c388","name":"Parser PDF - DOCS","credentials":{"httpHeaderAuth":{"id":"rDHcHgP5GNq3qUHB","name":"API Llamaindex"}}},{"parameters":{"url":"=https://api.cloud.llamaindex.ai/api/v1/parsing/job/{{ $json.id }}","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"}]},"sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1100,-360],"id":"c25e2dab-6ac4-4017-9116-202edbe0239f","name":"GET Parser PDF - DOCS","credentials":{"httpHeaderAuth":{"id":"rDHcHgP5GNq3qUHB","name":"API Llamaindex"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.status }}","rightValue":"SUCCESS","operator":{"type":"string","operation":"equals"},"id":"1ca170e5-f79b-45d0-bf06-8817aaa91020"}],"combinator":"and"},"renameOutput":true,"outputKey":"SUCCESS"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"6b32d09d-aca1-4ac2-add0-08fddb408eef","leftValue":"={{ $json.status }}","rightValue":"ERROR","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"ERROR"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8ed9a7f3-a77b-4541-a2c5-1ec659349c4c","leftValue":"={{ $json.status }}","rightValue":"PENDING","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"PENDING"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"728cff21-b861-4c35-a66f-1159958560fb","leftValue":"={{ $json.status }}","rightValue":"CANCELED","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"CANCELED"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[1300,-400],"id":"faaf62bd-efc8-43a4-b2e3-3c01fa0b04c0","name":"Status Job  PDF - DOC"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1500,-260],"id":"45216acb-e91b-4968-ad19-5706a309ea7d","name":"Wait Job PDF - DOC","webhookId":"f87508bf-6d05-4bd8-8d79-ebc5d503d0fd"},{"parameters":{"url":"=https://api.cloud.llamaindex.ai/api/v1/parsing/job/{{ $json.id }}/result/markdown","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1600,-480],"id":"070a6485-ad5d-4bfc-9f41-c36122263ff0","name":"Success PDF - DOC","credentials":{"httpHeaderAuth":{"id":"rDHcHgP5GNq3qUHB","name":"API Llamaindex"}}},{"parameters":{"method":"POST","url":"https://api.cloud.llamaindex.ai/api/v1/parsing/upload","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"parameterType":"formBinaryData","name":"file","inputDataFieldName":"data"},{"name":"spreadsheet_extract_sub_tables","value":"true"},{"name":"adaptive_long_table","value":"true"},{"name":"compact_markdown_table","value":"true"},{"name":"guess_xlsx_sheet_name","value":"true"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[920,60],"id":"a6c7f311-7aae-4e2e-8365-23dc1f3dca47","name":"Parser Excel","credentials":{"httpHeaderAuth":{"id":"rDHcHgP5GNq3qUHB","name":"API Llamaindex"}}},{"parameters":{"url":"=https://api.cloud.llamaindex.ai/api/v1/parsing/job/{{ $json.id }}","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"}]},"sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1100,80],"id":"8c3c3642-8851-45af-8194-d394c59d8dfa","name":"GET Parser Excel","credentials":{"httpHeaderAuth":{"id":"rDHcHgP5GNq3qUHB","name":"API Llamaindex"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.status }}","rightValue":"SUCCESS","operator":{"type":"string","operation":"equals"},"id":"1ca170e5-f79b-45d0-bf06-8817aaa91020"}],"combinator":"and"},"renameOutput":true,"outputKey":"SUCCESS"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"6b32d09d-aca1-4ac2-add0-08fddb408eef","leftValue":"={{ $json.status }}","rightValue":"ERROR","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"ERROR"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"728cff21-b861-4c35-a66f-1159958560fb","leftValue":"={{ $json.status }}","rightValue":"CANCELED","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"CANCELED"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8ed9a7f3-a77b-4541-a2c5-1ec659349c4c","leftValue":"={{ $json.status }}","rightValue":"PENDING","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"PENDING"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[1280,20],"id":"5a1c5f30-cde9-4aa0-8a82-432557a9b4ec","name":"Status Job Excel"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1460,100],"id":"080374f6-31dc-4ba7-9be4-2d7dc715ef69","name":"Wait Job Excel","webhookId":"f87508bf-6d05-4bd8-8d79-ebc5d503d0fd"},{"parameters":{"url":"=https://api.cloud.llamaindex.ai/api/v1/parsing/job/{{ $json.id }}/result/markdown","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1700,-60],"id":"61015595-9373-4522-90d3-7bab92af99a7","name":"Success Excel","credentials":{"httpHeaderAuth":{"id":"rDHcHgP5GNq3qUHB","name":"API Llamaindex"}}},{"parameters":{"errorMessage":"Error Job Parser PDF - DOC"},"type":"n8n-nodes-base.stopAndError","typeVersion":1,"position":[1580,20],"id":"b9730c66-6178-43a5-a284-0a84ed60375c","name":"Error Excel"},{"parameters":{"errorMessage":"Error Job Parser PDF - DOC"},"type":"n8n-nodes-base.stopAndError","typeVersion":1,"position":[1640,-340],"id":"a9ecf657-3a10-40d7-a42f-ffec21ea590a","name":"Error PDF - DOC"},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1560,660],"id":"725f9ba2-f1fc-4d1a-bd4a-7b3ce7f03221","name":"Wait Job Excel1","webhookId":"f87508bf-6d05-4bd8-8d79-ebc5d503d0fd"},{"parameters":{"method":"POST","url":"https://api.cloud.llamaindex.ai/api/v1/parsing/upload","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{"parameterType":"formBinaryData","name":"file","inputDataFieldName":"data"},{"name":"premium_mode","value":"true"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[980,540],"id":"bc320346-075e-4b5c-bce2-767509cdc7bf","name":"Parser PowerPoint","credentials":{"httpHeaderAuth":{"id":"rDHcHgP5GNq3qUHB","name":"API Llamaindex"}}},{"parameters":{"url":"=https://api.cloud.llamaindex.ai/api/v1/parsing/job/{{ $json.id }}","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{"name":"accept","value":"application/json"}]},"sendBody":true,"contentType":"multipart-form-data","bodyParameters":{"parameters":[{}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1200,540],"id":"67d2d09a-b122-4343-8334-a04b98b36cd9","name":"GET Parser PowerPoint","credentials":{"httpHeaderAuth":{"id":"rDHcHgP5GNq3qUHB","name":"API Llamaindex"}}},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json.status }}","rightValue":"SUCCESS","operator":{"type":"string","operation":"equals"},"id":"1ca170e5-f79b-45d0-bf06-8817aaa91020"}],"combinator":"and"},"renameOutput":true,"outputKey":"SUCCESS"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"6b32d09d-aca1-4ac2-add0-08fddb408eef","leftValue":"={{ $json.status }}","rightValue":"ERROR","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"ERROR"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"728cff21-b861-4c35-a66f-1159958560fb","leftValue":"={{ $json.status }}","rightValue":"CANCELED","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"CANCELED"},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8ed9a7f3-a77b-4541-a2c5-1ec659349c4c","leftValue":"={{ $json.status }}","rightValue":"PENDING","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"renameOutput":true,"outputKey":"PENDING"}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[1380,520],"id":"07260beb-c0e3-41de-be07-06d206b2adc1","name":"Status Job PowerPoint"},{"parameters":{"url":"=https://api.cloud.llamaindex.ai/api/v1/parsing/job/{{ $json.id }}/result/markdown","authentication":"genericCredentialType","genericAuthType":"httpHeaderAuth","sendHeaders":true,"headerParameters":{"parameters":[{}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1620,420],"id":"48531d55-265a-4517-b1c7-48ad068f94ec","name":"Success PowerPoint","credentials":{"httpHeaderAuth":{"id":"rDHcHgP5GNq3qUHB","name":"API Llamaindex"}}},{"parameters":{"errorMessage":"Error Job Parser PDF - DOC"},"type":"n8n-nodes-base.stopAndError","typeVersion":1,"position":[1700,560],"id":"133d1771-161f-48af-ae48-9083045e1f30","name":"Error PowerPoint"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[180,0],"id":"0880954b-acbb-4316-bea7-9e8fff8d8114","name":"Loop Over Items"},{"parameters":{"jsonMode":"expressionData","jsonData":"={{ $json.markdown }}","options":{}},"type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","typeVersion":1,"position":[2220,300],"id":"9e8ba330-cc94-4c85-a548-003bf19a9bfc","name":"Default Data Loader"},{"parameters":{"chunkSize":2000,"chunkOverlap":200,"options":{}},"type":"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter","typeVersion":1,"position":[2180,460],"id":"dab04ef7-deab-4a5f-ae2e-6270f188b325","name":"Recursive Character Text Splitter"},{"parameters":{"model":"bge-m3:567m-fp16"},"type":"@n8n/n8n-nodes-langchain.embeddingsOllama","typeVersion":1,"position":[2040,320],"id":"cac4e23d-5763-4058-81c4-4c7eac56d670","name":"Embeddings Ollama","credentials":{"ollamaApi":{"id":"JYeUAqP5ezUXeMAV","name":"Ollama JPG"}}},{"parameters":{"content":"## Workflow para Archivos PDF\n","height":400,"width":1000},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[860,-520],"id":"3d0c39ed-e944-4fb1-995c-f6f92d3e7199","name":"Sticky Note"},{"parameters":{"content":"## Wokflow para Archivos Excel","height":400,"width":980,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[880,-80],"id":"e65353d3-0d66-4b93-8a8d-5c37688c3860","name":"Sticky Note1"},{"parameters":{"content":"## Workflow para archivos de imagenes y powerpoint\n","height":500,"width":980,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[880,360],"id":"c72ea8c2-40fd-4b8a-9c8b-22c042c43ff4","name":"Sticky Note2"},{"parameters":{"content":"## Vectorizacion de documentos\n","height":640,"width":560},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1940,-20],"id":"289608c7-6cbb-42e6-b461-07e0ba0905d2","name":"Sticky Note3"},{"parameters":{"mode":"insert","qdrantCollection":{"__rl":true,"value":"ifx_products","mode":"list","cachedResultName":"ifx_products"},"embeddingBatchSize":1024,"options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStoreQdrant","typeVersion":1.1,"position":[2140,80],"id":"993269b1-9974-48a0-aeee-6943f5dd7175","name":"Qdrant BD sahrepoint_ifx","credentials":{"qdrantApi":{"id":"v6ZCaJ75SthKWZjJ","name":"QdrantAPI AIFX"}}}],"connections":{"When clicking ‘Test workflow’":{"main":[[{"node":"Microsoft SharePoint HTTP Request1","type":"main","index":0}]]},"Microsoft SharePoint HTTP Request1":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Microsoft SharePoint HTTP Request":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Code1":{"main":[[{"node":"Switch","type":"main","index":0}]]},"Switch":{"main":[[{"node":"Parser PDF - DOCS","type":"main","index":0}],[{"node":"Parser PDF - DOCS","type":"main","index":0}],[{"node":"Parser PDF - DOCS","type":"main","index":0}],[{"node":"Parser Excel","type":"main","index":0}],[{"node":"Parser Excel","type":"main","index":0}],[{"node":"Parser PowerPoint","type":"main","index":0}],[{"node":"Parser PowerPoint","type":"main","index":0}],[{"node":"Parser PowerPoint","type":"main","index":0}],[{"node":"Parser PowerPoint","type":"main","index":0}]]},"Parser PDF - DOCS":{"main":[[{"node":"GET Parser PDF - DOCS","type":"main","index":0}]]},"GET Parser PDF - DOCS":{"main":[[{"node":"Status Job  PDF - DOC","type":"main","index":0}]]},"Status Job  PDF - DOC":{"main":[[{"node":"Success PDF - DOC","type":"main","index":0}],[{"node":"Error PDF - DOC","type":"main","index":0}],[{"node":"Wait Job PDF - DOC","type":"main","index":0}],[{"node":"Error PDF - DOC","type":"main","index":0}]]},"Wait Job PDF - DOC":{"main":[[{"node":"GET Parser PDF - DOCS","type":"main","index":0}]]},"Parser Excel":{"main":[[{"node":"GET Parser Excel","type":"main","index":0}]]},"GET Parser Excel":{"main":[[{"node":"Status Job Excel","type":"main","index":0}]]},"Status Job Excel":{"main":[[{"node":"Success Excel","type":"main","index":0}],[{"node":"Error Excel","type":"main","index":0}],[{"node":"Error Excel","type":"main","index":0}],[{"node":"Wait Job Excel","type":"main","index":0}]]},"Wait Job Excel":{"main":[[{"node":"GET Parser Excel","type":"main","index":0}]]},"Wait Job Excel1":{"main":[[{"node":"GET Parser PowerPoint","type":"main","index":0}]]},"Parser PowerPoint":{"main":[[{"node":"GET Parser PowerPoint","type":"main","index":0}]]},"GET Parser PowerPoint":{"main":[[{"node":"Status Job PowerPoint","type":"main","index":0}]]},"Status Job PowerPoint":{"main":[[{"node":"Success PowerPoint","type":"main","index":0}],[{"node":"Error PowerPoint","type":"main","index":0}],[{"node":"Error PowerPoint","type":"main","index":0}],[{"node":"Wait Job Excel1","type":"main","index":0}]]},"Success PDF - DOC":{"main":[[{"node":"Qdrant BD sahrepoint_ifx","type":"main","index":0}]]},"Success Excel":{"main":[[{"node":"Qdrant BD sahrepoint_ifx","type":"main","index":0}]]},"Success PowerPoint":{"main":[[{"node":"Qdrant BD sahrepoint_ifx","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Microsoft SharePoint HTTP Request","type":"main","index":0}]]},"Default Data Loader":{"ai_document":[[{"node":"Qdrant BD sahrepoint_ifx","type":"ai_document","index":0}]]},"Recursive Character Text Splitter":{"ai_textSplitter":[[{"node":"Default Data Loader","type":"ai_textSplitter","index":0}]]},"Embeddings Ollama":{"ai_embedding":[[{"node":"Qdrant BD sahrepoint_ifx","type":"ai_embedding","index":0}]]},"Qdrant BD sahrepoint_ifx":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"3e9be325-a9f6-42ef-92fa-8336cde79bd4","triggerCount":0,"tags":[]}