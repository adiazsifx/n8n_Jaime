{"createdAt":"2025-04-21T00:55:17.696Z","updatedAt":"2025-04-21T01:46:47.000Z","id":"3QXKVkbLKyrWVYUR","name":"Vector Database RAG Productos IFX","active":false,"nodes":[{"parameters":{"operation":"text","options":{"encoding":"utf8","keepSource":"json"}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[0,260],"id":"5ece0d5b-67b4-44c7-8e3c-1e7f31508787","name":"Extract from File"},{"parameters":{"mode":"insert","qdrantCollection":{"__rl":true,"value":"productos_ifx","mode":"list","cachedResultName":"productos_ifx"},"embeddingBatchSize":1024,"options":{}},"type":"@n8n/n8n-nodes-langchain.vectorStoreQdrant","typeVersion":1.1,"position":[260,260],"id":"4e8be158-da4a-4176-ba5d-c4b5bdb9fb90","name":"Qdrant Vector Store","credentials":{"qdrantApi":{"id":"v6ZCaJ75SthKWZjJ","name":"QdrantAPI AIFX"}}},{"parameters":{"model":"embedding-model","options":{}},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[160,440],"id":"5616733f-1e10-405c-b4dc-52beda0f264d","name":"Embeddings OpenAI","credentials":{"openAiApi":{"id":"3ksygUY2AafRzzfk","name":"Proxy LiteLLM"}}},{"parameters":{"jsonMode":"expressionData","jsonData":"={{ $json.originalFilename }}\n{{ $json.data }}","options":{}},"type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","typeVersion":1,"position":[340,420],"id":"f186e09f-40ec-43a4-8162-169ee37a872e","name":"Default Data Loader"},{"parameters":{"chunkSize":2000,"chunkOverlap":200,"options":{}},"type":"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter","typeVersion":1,"position":[300,580],"id":"13eca3d7-9d79-4d2a-851b-5807294f4a52","name":"Recursive Character Text Splitter"},{"parameters":{"resource":"fileFolder","limit":1,"filter":{"folderId":{"__rl":true,"value":"1IYiFur-fRntuaMFyuoWFo93rU0k0t_VB","mode":"list","cachedResultName":"Productos IFX","cachedResultUrl":"https://drive.google.com/drive/folders/1IYiFur-fRntuaMFyuoWFo93rU0k0t_VB"}},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[-1020,260],"id":"d881aa80-f837-467d-9971-cc98d0b5b0dc","name":"Search New Doc","credentials":{"googleDriveOAuth2Api":{"id":"KeJeYvddxw0ubE33","name":"Google Drive JPG"}}},{"parameters":{"operation":"download","fileId":{"__rl":true,"value":"={{ $('Search New Doc').item.json.id }}","mode":"id"},"options":{}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[-180,260],"id":"a7c76952-8a6e-4c2f-b184-45a7e807f380","name":"Download File","alwaysOutputData":true,"credentials":{"googleDriveOAuth2Api":{"id":"KeJeYvddxw0ubE33","name":"Google Drive JPG"}}},{"parameters":{"operation":"move","fileId":{"__rl":true,"value":"={{ $('Search New Doc').item.json.id }}","mode":"id"},"driveId":{"__rl":true,"mode":"list","value":"My Drive"},"folderId":{"__rl":true,"value":"1ZnYGjniVJMB245XE0CaCxa6MRCrrSddC","mode":"list","cachedResultName":"Read Docs","cachedResultUrl":"https://drive.google.com/drive/folders/1ZnYGjniVJMB245XE0CaCxa6MRCrrSddC"}},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[180,0],"id":"4f0f716b-77a6-42bc-b781-e91a542bad4b","name":"Move File Read","credentials":{"googleDriveOAuth2Api":{"id":"KeJeYvddxw0ubE33","name":"Google Drive JPG"}}},{"parameters":{"pollTimes":{"item":[{"hour":23}]},"triggerOn":"specificFolder","folderToWatch":{"__rl":true,"value":"1IYiFur-fRntuaMFyuoWFo93rU0k0t_VB","mode":"list","cachedResultName":"Productos IFX","cachedResultUrl":"https://drive.google.com/drive/folders/1IYiFur-fRntuaMFyuoWFo93rU0k0t_VB"},"event":"fileUpdated","options":{}},"type":"n8n-nodes-base.googleDriveTrigger","typeVersion":1,"position":[-1260,280],"id":"3eeb08ad-8c56-408e-960f-3a49d2bf3c69","name":"Trigger New File","credentials":{"googleDriveOAuth2Api":{"id":"KeJeYvddxw0ubE33","name":"Google Drive JPG"}}},{"parameters":{"documentId":{"__rl":true,"value":"1EZt7LAlzJlkwfvaomrm-TWoSSI3aZadOivUd4459_pQ","mode":"list","cachedResultName":"check_id_exist","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1EZt7LAlzJlkwfvaomrm-TWoSSI3aZadOivUd4459_pQ/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"check_data","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1EZt7LAlzJlkwfvaomrm-TWoSSI3aZadOivUd4459_pQ/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"id_file","lookupValue":"={{ $json.id }}"}]},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.5,"position":[-580,280],"id":"4d632e78-2f2a-4ecc-b326-180713759f3e","name":"Google Sheets","alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"RAFBPo90gKsl6IpE","name":"API Google FutureBit"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"13dedf7b-b8ea-4e5a-a2d3-50e2d5296c6b","leftValue":"={{ $('Google Sheets').item.json.isEmpty() }}","rightValue":"","operator":{"type":"boolean","operation":"true","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-400,280],"id":"dfe2816f-d3a0-46db-8f72-2e7f2902beaa","name":"File Not Exist"},{"parameters":{"operation":"appendOrUpdate","documentId":{"__rl":true,"value":"1EZt7LAlzJlkwfvaomrm-TWoSSI3aZadOivUd4459_pQ","mode":"list","cachedResultName":"check_id_exist","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1EZt7LAlzJlkwfvaomrm-TWoSSI3aZadOivUd4459_pQ/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"check_data","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1EZt7LAlzJlkwfvaomrm-TWoSSI3aZadOivUd4459_pQ/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"id_file":"={{ $('Search New Doc').item.json.id }}"},"matchingColumns":["id_file"],"schema":[{"id":"id_file","displayName":"id_file","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.5,"position":[0,0],"id":"c39ddf15-df78-4cec-b2a7-e115768b4a76","name":"Google Sheets1","alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"RAFBPo90gKsl6IpE","name":"API Google FutureBit"}}},{"parameters":{},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[620,260],"id":"3c70bde7-e786-4720-ae94-11ac0787e29b","name":"Wait1","webhookId":"c0dcbdab-d2a0-4e2f-9bba-dfc502701833"},{"parameters":{"jsCode":"const uniqueItems = [];\nconst seenIds = new Set();\n\nfor (const item of items) {\n  const id = item.json.id;\n  if (!seenIds.has(id)) {\n    seenIds.add(id);\n    uniqueItems.push(item);\n  }\n}\n\nreturn uniqueItems;"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-820,260],"id":"9d082a7c-c6a1-4762-b441-b2f94ec31396","name":"Code1"}],"connections":{"Extract from File":{"main":[[{"node":"Qdrant Vector Store","type":"main","index":0}]]},"Qdrant Vector Store":{"main":[[{"node":"Wait1","type":"main","index":0}]]},"Embeddings OpenAI":{"ai_embedding":[[{"node":"Qdrant Vector Store","type":"ai_embedding","index":0}]]},"Default Data Loader":{"ai_document":[[{"node":"Qdrant Vector Store","type":"ai_document","index":0}]]},"Recursive Character Text Splitter":{"ai_textSplitter":[[{"node":"Default Data Loader","type":"ai_textSplitter","index":0}]]},"Search New Doc":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Download File":{"main":[[{"node":"Google Sheets1","type":"main","index":0},{"node":"Extract from File","type":"main","index":0}]]},"Trigger New File":{"main":[[{"node":"Search New Doc","type":"main","index":0}]]},"Google Sheets":{"main":[[{"node":"File Not Exist","type":"main","index":0}]]},"File Not Exist":{"main":[[{"node":"Download File","type":"main","index":0}]]},"Google Sheets1":{"main":[[{"node":"Move File Read","type":"main","index":0}]]},"Wait1":{"main":[[{"node":"Search New Doc","type":"main","index":0}]]},"Code1":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"8a231cce-e596-4986-bf94-a0156e761801","triggerCount":0,"tags":[]}